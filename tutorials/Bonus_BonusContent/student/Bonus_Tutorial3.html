
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.18.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Tutorial 3: Autoencoders applications — Insert your title here. e.g. Neuromatch Academy: Computational Neuroscience</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link href="../../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css?digest=4ec06e9971c5264fbd345897d5258098f11cc577" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css">
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css">
<link href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94" rel="preload"/>
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=8bf782fb4ee92b3d3646425e50f299c4e1fd152d"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../../../_static/togglebutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script src="../../../_static/design-tabs.js"></script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script type="application/vnd.jupyter.widget-state+json">{"state": {"ff5eb1305e2e43c1a148ad22e3662444": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d3dac9dc80334b13a6970634c89b94b0": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ff5eb1305e2e43c1a148ad22e3662444", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=_bzW_jkH6l0\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7f1c926cd6a0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/_bzW_jkH6l0?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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\n"}}], "tabbable": null, "tooltip": null}}, "ca36cead92ec4094a50c5082493f81a4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "27a4687c6de5405d82623d415c1452a0": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ca36cead92ec4094a50c5082493f81a4", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV12v411q7nS\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.PlayVideo at 0x7f1d7c60b1f0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV12v411q7nS&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}], "tabbable": null, "tooltip": null}}, "d31f0469efaf4967b0b1c532dfe8ea8b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "26aadc80271544a48d6c0850d08a0250": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TabModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_d3dac9dc80334b13a6970634c89b94b0", "IPY_MODEL_27a4687c6de5405d82623d415c1452a0"], "layout": "IPY_MODEL_d31f0469efaf4967b0b1c532dfe8ea8b", "selected_index": 0, "tabbable": null, "titles": ["Youtube", "Bilibili"], "tooltip": null}}, "8a53a0b7f37b49d69edda401b967f930": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "3f09708bcb8d4775b5cd357b05671c47": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "10e843e37da2493198ed6b8c94246fa1": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_8a53a0b7f37b49d69edda401b967f930", "style": "IPY_MODEL_3f09708bcb8d4775b5cd357b05671c47", "tabbable": null, "tooltip": "happy"}}, "1902d114ebdc416b984dc475412985b6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "a4e6aaa0bd654dd5890f921ff8b41469": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "76c50ca2414e498a895a22a8ccba720a": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_1902d114ebdc416b984dc475412985b6", "style": "IPY_MODEL_a4e6aaa0bd654dd5890f921ff8b41469", "tabbable": null, "tooltip": "medium"}}, "66f1971b0cd24787be85baab47bb42d2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "c6380304fef246b9bcbf80d329f3c781": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "fd5d0caa61e842b6a8db53f359fbec30": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_66f1971b0cd24787be85baab47bb42d2", "style": "IPY_MODEL_c6380304fef246b9bcbf80d329f3c781", "tabbable": null, "tooltip": "sad"}}, "fe9e5c9f0fdd4247901bfe2100681da5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "2c10ea41493f4e0aae206e2d3256ad02": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "b2b79b7191204866ac61bff6a61437b5": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_fe9e5c9f0fdd4247901bfe2100681da5", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_2c10ea41493f4e0aae206e2d3256ad02", "tabbable": null, "tooltip": null, "value": ""}}, "1bd5a9287e074a1aa512fa8db64bae2d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "3ac77b6bd1504950914cfbe79640ff83": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "ef32bf10817b43b09a4bfa1b99479e62": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_1bd5a9287e074a1aa512fa8db64bae2d", "style": "IPY_MODEL_3ac77b6bd1504950914cfbe79640ff83", "tabbable": null, "tooltip": null}}, "acad72b3fe254b29a37ec43a5a762977": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8df89f7c45f542268b9fc220ef70e42e": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_b2b79b7191204866ac61bff6a61437b5", "IPY_MODEL_ef32bf10817b43b09a4bfa1b99479e62"], "layout": "IPY_MODEL_acad72b3fe254b29a37ec43a5a762977", "tabbable": null, "tooltip": null}}, "458a0137470140778819c9f43438c720": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0849d1d8487b4b249cb26bc5c2314f1b": {"model_name": "LabelStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "a35fc676307a4cdfbb8a381673ef403f": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "LabelView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_458a0137470140778819c9f43438c720", "placeholder": "\u200b", "style": "IPY_MODEL_0849d1d8487b4b249cb26bc5c2314f1b", "tabbable": null, "tooltip": null, "value": "Thanks for your feedback!"}}, "fc48566334b34f3cbd0217f715085d5f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e9fc8ac4bf284241b74b06f83712c5b3": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_10e843e37da2493198ed6b8c94246fa1", "IPY_MODEL_76c50ca2414e498a895a22a8ccba720a", "IPY_MODEL_fd5d0caa61e842b6a8db53f359fbec30"], "layout": "IPY_MODEL_fc48566334b34f3cbd0217f715085d5f", "tabbable": null, "tooltip": null}}, "ed368bc8aae64b08a3769b68efab1820": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "54c59483bad24e0fbb70d3ea891d1c7c": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_e9fc8ac4bf284241b74b06f83712c5b3", "IPY_MODEL_8df89f7c45f542268b9fc220ef70e42e", "IPY_MODEL_a35fc676307a4cdfbb8a381673ef403f"], "layout": "IPY_MODEL_ed368bc8aae64b08a3769b68efab1820", "tabbable": null, "tooltip": null}}, "44f8ae67cca446d890ea1e44ab4a2eae": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "becb4bafdbfd4ecbb251a94e34d7c0eb": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_54c59483bad24e0fbb70d3ea891d1c7c"], "layout": "IPY_MODEL_44f8ae67cca446d890ea1e44ab4a2eae", "tabbable": null, "tooltip": null}}, "bb739e5bda4e4be6847289f526e34dcd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "3acdc6b37ae44d91b55579490632d108": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "e447b7f5eafb4005ac16f0c770692e07": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_bb739e5bda4e4be6847289f526e34dcd", "style": "IPY_MODEL_3acdc6b37ae44d91b55579490632d108", "tabbable": null, "tooltip": "happy"}}, "6f9535f6b8534535b862a90c5a5d90ae": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "a115b64cd15342b2bbaba799bbeeac54": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "57c2cc30774a4dfcb79ca16fa5dcdc82": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_6f9535f6b8534535b862a90c5a5d90ae", "style": "IPY_MODEL_a115b64cd15342b2bbaba799bbeeac54", "tabbable": null, "tooltip": "medium"}}, "d072a11723264669afccfb1e29f09dc9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "58fd4b3706a84fe08989703df2912b51": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "b49aa0bd5434445f92c26d4d5022f7a4": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_d072a11723264669afccfb1e29f09dc9", "style": "IPY_MODEL_58fd4b3706a84fe08989703df2912b51", "tabbable": null, "tooltip": "sad"}}, "dc359a543a0a4fb69647fe94321b1724": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "aa63a549ae734c2780e726e05511b717": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "11d4a5b836d041739bdbc4efbc513fbf": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_dc359a543a0a4fb69647fe94321b1724", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_aa63a549ae734c2780e726e05511b717", "tabbable": null, "tooltip": null, "value": ""}}, "4fffb7e77a294c01b42b7b57b3cd0de4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "7e45d8be5eaa45d4a81c8721e15c840a": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "ce02793607b14e149a1829ef05c69ec7": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_4fffb7e77a294c01b42b7b57b3cd0de4", "style": "IPY_MODEL_7e45d8be5eaa45d4a81c8721e15c840a", "tabbable": null, "tooltip": null}}, "53e63fcce98e4c9fbb52b7a5d3425a6b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c2bf1d4987c14b49b9e1cf5bd971e137": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_11d4a5b836d041739bdbc4efbc513fbf", "IPY_MODEL_ce02793607b14e149a1829ef05c69ec7"], "layout": "IPY_MODEL_53e63fcce98e4c9fbb52b7a5d3425a6b", "tabbable": null, "tooltip": null}}, "3f5207579af84da28127e9cc6e5636bd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8dd85b0812224990847299b8c5194a86": {"model_name": "LabelStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "0468985f800349b387926d1e2d810487": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "LabelView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3f5207579af84da28127e9cc6e5636bd", "placeholder": "\u200b", "style": "IPY_MODEL_8dd85b0812224990847299b8c5194a86", "tabbable": null, "tooltip": null, "value": "Thanks for your feedback!"}}, "71ee6a3c1dd04eb6afcee260b6d0648f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c582fca86f224a97ab92e1341304b613": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_e447b7f5eafb4005ac16f0c770692e07", "IPY_MODEL_57c2cc30774a4dfcb79ca16fa5dcdc82", "IPY_MODEL_b49aa0bd5434445f92c26d4d5022f7a4"], "layout": "IPY_MODEL_71ee6a3c1dd04eb6afcee260b6d0648f", "tabbable": null, "tooltip": null}}, "93c45217009b4fb4b0d134a5e6f75390": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cde8eb553c6347fa98199bdd2985ac72": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_c582fca86f224a97ab92e1341304b613", "IPY_MODEL_c2bf1d4987c14b49b9e1cf5bd971e137", "IPY_MODEL_0468985f800349b387926d1e2d810487"], "layout": "IPY_MODEL_93c45217009b4fb4b0d134a5e6f75390", "tabbable": null, "tooltip": null}}, "5c10b969107e4a7cac5510d8a5c2e971": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c064686425a2460f94b83edf6929d66b": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_cde8eb553c6347fa98199bdd2985ac72"], "layout": "IPY_MODEL_5c10b969107e4a7cac5510d8a5c2e971", "tabbable": null, "tooltip": null}}, "108418da9d29421e80819568eab4e32d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f8a258d01d0b451897310ee1a503f5cd": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_108418da9d29421e80819568eab4e32d", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=ziiZK9P6AXQ\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7f1c8e5ce070>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/ziiZK9P6AXQ?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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\n"}}], "tabbable": null, "tooltip": null}}, "96aff14360b445c2891c69de6af15610": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b67d77b5a7644a749dffec3fba087a02": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_96aff14360b445c2891c69de6af15610", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV1ph411Z7uh\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.PlayVideo at 0x7f1c8f93bf40>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1ph411Z7uh&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}], "tabbable": null, "tooltip": null}}, "723dab5e48bd4392955d2ef970230132": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4ec98b64c79d41a79d0a3718ad49be29": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TabModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_f8a258d01d0b451897310ee1a503f5cd", "IPY_MODEL_b67d77b5a7644a749dffec3fba087a02"], "layout": "IPY_MODEL_723dab5e48bd4392955d2ef970230132", "selected_index": 0, "tabbable": null, "titles": ["Youtube", "Bilibili"], "tooltip": null}}, "5967e53fdf064df195a5db39a6bdbae0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "3c38a7a1f018414fbbbcdc33522c53c6": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "78b346a522834095b40f4047ed754c87": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_5967e53fdf064df195a5db39a6bdbae0", "style": "IPY_MODEL_3c38a7a1f018414fbbbcdc33522c53c6", "tabbable": null, "tooltip": "happy"}}, "957bc15eb8334e2996eea373c9d476b0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "aa1fae5f40734b3e94d370ba1ccae006": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "1ea33845dbaa4be58cc17dfd8b57333c": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_957bc15eb8334e2996eea373c9d476b0", "style": "IPY_MODEL_aa1fae5f40734b3e94d370ba1ccae006", "tabbable": null, "tooltip": "medium"}}, "c8448a26dd5c46c2bbd8ca3148980090": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "95c5616adb42462da07644e1de246f8f": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "db453d22c7f04a98aad796b1351ca602": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_c8448a26dd5c46c2bbd8ca3148980090", "style": "IPY_MODEL_95c5616adb42462da07644e1de246f8f", "tabbable": null, "tooltip": "sad"}}, "ef16e33590c24b8a923b58e2491ac031": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "b81159f84c684741a0e89fda6c179e91": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "42e9a8de32974d34bb7381db9fddec8c": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_ef16e33590c24b8a923b58e2491ac031", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_b81159f84c684741a0e89fda6c179e91", "tabbable": null, "tooltip": null, "value": ""}}, "97fd3938c6d54e26b6fcd4e5895932a3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "5443d8b280b041e3af079831ac91956d": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "263e189e8b28480585cf5a2cd30306ae": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_97fd3938c6d54e26b6fcd4e5895932a3", "style": "IPY_MODEL_5443d8b280b041e3af079831ac91956d", "tabbable": null, "tooltip": null}}, "f2c33d27cae449be9aecf014f44006a9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "966e0bc49c3d48e7bdbd2eae26b817af": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_42e9a8de32974d34bb7381db9fddec8c", "IPY_MODEL_263e189e8b28480585cf5a2cd30306ae"], "layout": "IPY_MODEL_f2c33d27cae449be9aecf014f44006a9", "tabbable": null, "tooltip": null}}, "c1667dfb14074452929c0364d73d729c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "10063fc00c0e4766b2a04ee012e671a6": {"model_name": "LabelStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "31f90faffdb044a8a05f4ed16c9a6d1d": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "LabelView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c1667dfb14074452929c0364d73d729c", "placeholder": "\u200b", "style": "IPY_MODEL_10063fc00c0e4766b2a04ee012e671a6", "tabbable": null, "tooltip": null, "value": "Thanks for your feedback!"}}, "587902f8d92d40cf9093140836f2ffa8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "154e4f4d394946c09958b1da7a9eff34": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_78b346a522834095b40f4047ed754c87", "IPY_MODEL_1ea33845dbaa4be58cc17dfd8b57333c", "IPY_MODEL_db453d22c7f04a98aad796b1351ca602"], "layout": "IPY_MODEL_587902f8d92d40cf9093140836f2ffa8", "tabbable": null, "tooltip": null}}, "f9e12bbd5f664cb697951f5675eb7475": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "188b8d19057c49c4b137b1d39637ead7": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_154e4f4d394946c09958b1da7a9eff34", "IPY_MODEL_966e0bc49c3d48e7bdbd2eae26b817af", "IPY_MODEL_31f90faffdb044a8a05f4ed16c9a6d1d"], "layout": "IPY_MODEL_f9e12bbd5f664cb697951f5675eb7475", "tabbable": null, "tooltip": null}}, "90b3f8452caa4c8dbbb3978ec9f457df": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "66b2a4924ca34666a5d744b9dfdc8c53": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_188b8d19057c49c4b137b1d39637ead7"], "layout": "IPY_MODEL_90b3f8452caa4c8dbbb3978ec9f457df", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/Bonus_BonusContent/student/Bonus_Tutorial3';</script>
<link href="../../../_static/nma-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index">
<link href="../../../search.html" rel="search" title="Search"/>
<link href="Bonus_Outro.html" rel="next" title="Outro"/>
<link href="Bonus_Tutorial2.html" rel="prev" title="Tutorial 2: Autoencoder extensions"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</link></link></link></link></link></link></link></link></link></head>
<body data-default-mode="" data-offset="180" data-spy="scroll" data-target="#bd-toc-nav">
<a class="skip-link" href="#main-content">Skip to main content</a>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
<label class="sidebar-toggle primary-toggle" for="__primary">
<span class="fa-solid fa-bars"></span>
</label>
<div id="navbar-start">
<a class="navbar-brand logo" href="../../intro.html">
<img alt="Logo image" class="logo__image only-light" src="../../../_static/nma-logo-square-4xp.png"/>
<img alt="Logo image" class="logo__image only-dark" src="../../../_static/nma-logo-square-4xp.png"/>
</a>
</div>
<div class="col-lg-9 navbar-header-items">
<div class="mr-auto" id="navbar-center">
<div class="navbar-center-item">
<nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
<ul class="navbar-nav" id="navbar-main-elements">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Schedule/schedule_intro.html">
                        Schedule
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/tech_intro.html">
                        Technical Help
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/Links_Policy.html">
                        Quick links and policies
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../prereqs/ComputationalNeuroscience.html">
                        Prerequisites and preparatory materials for NMA Computational Neuroscience
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
                        Neuro Video Series (W0D0)
                      </a>
</li>
<div class="nav-item dropdown">
<button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
<div class="dropdown-menu">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
                        Python Workshop 1 (W0D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
                        Python Workshop 2 (W0D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
                        Linear Algebra (W0D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D4_Calculus/chapter_title.html">
                        Calculus (W0D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D5_Statistics/chapter_title.html">
                        Statistics (W0D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D1_Instructions/chapter_title.html">
                        Instructions (W1D1)
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../chapter_title.html">
                        Bonus Content (Bonus)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/CourseContentTemplateInstructions.html">
                        Course Content Template Instructions Wrap-Up
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D2_Template/chapter_title.html">
                        Template (W1D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/InsertCategoryNameHere.html">
                        Insert Category Name Here Wrap-Up
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/README.html">
                        Introduction
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/keynote.html">
                        Project Day keynote (W2D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/project_guidance.html">
                        Daily guide for projects
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/datasets_overview.html">
                        Project materials
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/continuing_your_project_after_the_course.html">
                        Continuing your project after the course
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/past_projects_overview.html">
                        Past projects
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/professional_development/README.html">
                        Introduction
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/professional_development/impact_talks.html">
                        Impact Talks
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/professional_development/career_features.html">
                        Career Features
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/professional_development/career_panels.html">
                        Career Panels
                      </a>
</li>
</div>
</div>
</ul>
</nav>
</div>
</div>
<div id="navbar-end">
<div class="navbar-end-item navbar-persistent--container">
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass"></i>
</button>
</div>
<div class="navbar-end-item">
<button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
<span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
<span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
<span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
</div>
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
</ul>
</div>
</div>
</div>
<div class="navbar-persistent--mobile">
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass"></i>
</button>
</div>
<label class="sidebar-toggle secondary-toggle" for="__secondary">
<span class="fa-solid fa-outdent"></span>
</label>
</div>
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-center-item">
<nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
<ul class="navbar-nav" id="navbar-main-elements">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Schedule/schedule_intro.html">
                        Schedule
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/tech_intro.html">
                        Technical Help
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/Links_Policy.html">
                        Quick links and policies
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../prereqs/ComputationalNeuroscience.html">
                        Prerequisites and preparatory materials for NMA Computational Neuroscience
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
                        Neuro Video Series (W0D0)
                      </a>
</li>
<div class="nav-item dropdown">
<button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
<div class="dropdown-menu">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
                        Python Workshop 1 (W0D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
                        Python Workshop 2 (W0D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
                        Linear Algebra (W0D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D4_Calculus/chapter_title.html">
                        Calculus (W0D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W0D5_Statistics/chapter_title.html">
                        Statistics (W0D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D1_Instructions/chapter_title.html">
                        Instructions (W1D1)
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../chapter_title.html">
                        Bonus Content (Bonus)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/CourseContentTemplateInstructions.html">
                        Course Content Template Instructions Wrap-Up
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D2_Template/chapter_title.html">
                        Template (W1D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/InsertCategoryNameHere.html">
                        Insert Category Name Here Wrap-Up
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/README.html">
                        Introduction
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/keynote.html">
                        Project Day keynote (W2D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/project_guidance.html">
                        Daily guide for projects
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/datasets_overview.html">
                        Project materials
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/continuing_your_project_after_the_course.html">
                        Continuing your project after the course
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/past_projects_overview.html">
                        Past projects
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/professional_development/README.html">
                        Introduction
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/professional_development/impact_talks.html">
                        Impact Talks
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/professional_development/career_features.html">
                        Career Features
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/professional_development/career_panels.html">
                        Career Panels
                      </a>
</li>
</div>
</div>
</ul>
</nav>
</div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-end-item">
<button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
<span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
<span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
<span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
</div>
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
</ul>
</div>
</div>
</div>
<div class="sidebar-start-items sidebar-primary__section">
<div class="sidebar-start-items__item">
<a class="navbar-brand logo" href="../../intro.html">
<img alt="Logo image" class="logo__image only-light" src="../../../_static/nma-logo-square-4xp.png"/>
<img alt="Logo image" class="logo__image only-dark" src="../../../_static/nma-logo-square-4xp.png"/>
</a>
</div>
<div class="sidebar-start-items__item">
<form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
<div class="sidebar-start-items__item"><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Schedule/schedule_intro.html">Schedule</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Schedule/daily_schedules.html">General schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Schedule/shared_calendars.html">Shared calendars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Schedule/timezone_widget.html">Timezone widget</a></li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TechnicalHelp/tech_intro.html">Technical Help</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">Using jupyterbook</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">Using Google Colab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">Using Kaggle</a></li>
</ul>
</input></li>
<li class="toctree-l2"><a class="reference internal" href="../../TechnicalHelp/Discord.html">Using discord</a></li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">Quick links and policies</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../prereqs/ComputationalNeuroscience.html">Prerequisites and preparatory materials for NMA Computational Neuroscience</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pre-reqs Refresher</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">Neuro Video Series (W0D0)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial1.html">Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial2.html">Human Psychophysics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial3.html">Behavioral Readout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial4.html">Live in Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial5.html">Brain Signals: Spiking Activity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial6.html">Brain Signals: LFP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial7.html">Brain Signals: EEG &amp; MEG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial8.html">Brain Signals: fMRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial9.html">Brain Signals: Calcium Imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial10.html">Stimulus Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial11.html">Neurotransmitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial12.html">Neurons to Consciousness</a></li>
</ul>
</input></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">Python Workshop 1 (W0D1)</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W0D1_PythonWorkshop1/student/W0D1_Tutorial1.html">Tutorial: LIF Neuron Part I</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">Python Workshop 2 (W0D2)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W0D2_PythonWorkshop2/student/W0D2_Tutorial1.html">Tutorial 1: LIF Neuron Part II</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">Linear Algebra (W0D3)</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial1.html">Tutorial 1: Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial2.html">Tutorial 2: Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial3.html">Bonus Tutorial: Discrete Dynamical Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Outro.html">Outro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_DaySummary.html">Day Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W0D4_Calculus/chapter_title.html">Calculus (W0D4)</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial1.html">Tutorial 1: Differentiation and Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial2.html">Tutorial 2: Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial3.html">Tutorial 3: Numerical Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D4_Calculus/student/W0D4_DaySummary.html">Day Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">Statistics (W0D5)</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial1.html">Tutorial 1: Probability Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial2.html">Tutorial 2: Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Outro.html">Outro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W0D5_Statistics/student/W0D5_DaySummary.html">Day Summary</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Content Template Instructions</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D1_Instructions/chapter_title.html">Instructions (W1D1)</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/student/W1D1_Intro.html">Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/student/W1D1_Tutorial1.html">Tutorial 1: Importing the Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/student/W1D1_Tutorial2.html">Tutorial 2: Github Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/student/W1D1_Tutorial3.html">Tutorial 3: Content Enhancements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/student/W1D1_Tutorial4.html">Tutorial 4: Extra Notebook Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/student/W1D1_Tutorial5.html">Tutorial 5: Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/student/W1D1_Tutorial6.html">Tutorial 6: Professional Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/student/W1D1_Outro.html">Outro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/further_reading.html">Suggested further readings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_Instructions/student/W1D1_DaySummary.html">Day Summary</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../chapter_title.html">Bonus Content (Bonus)</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Bonus_Intro.html">Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bonus_Tutorial1.html">Tutorial 1: Intro to Autoencoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bonus_Tutorial2.html">Tutorial 2: Autoencoder extensions</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tutorial 3: Autoencoders applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bonus_Outro.html">Outro</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Module_WrapUps/CourseContentTemplateInstructions.html">Course Content Template Instructions Wrap-Up</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Insert Category Name Here</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D2_Template/chapter_title.html">Template (W1D2)</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_Template/student/W1D2_Intro.html">Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_Template/student/W1D2_Tutorial1.html">Tutorial [NUMBER]: Tutorial’s name</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_Template/student/W1D2_Outro.html">Outro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_Template/further_reading.html">Suggested further readings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_Template/student/W1D2_DaySummary.html">Day Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Module_WrapUps/InsertCategoryNameHere.html">Insert Category Name Here Wrap-Up</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project Booklet</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../projects/README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/keynote.html">Project Day keynote (W2D2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/docs/project_guidance.html">Daily guide for projects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../projects/docs/datasets_overview.html">Project materials</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/project-notebooks/Example_project.html">Project Template</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/docs/continuing_your_project_after_the_course.html">Continuing your project after the course</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../projects/docs/past_projects_overview.html">Past projects</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/past-projects/example_past_project.html">Example Past Project</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Professional Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../projects/professional_development/README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/professional_development/impact_talks.html">Impact Talks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/professional_development/career_features.html">Career Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/professional_development/career_panels.html">Career Panels</a></li>
</ul>
</div>
</nav>
</div>
</div>
<div class="sidebar-end-items sidebar-primary__section">
<div class="sidebar-end-items__item">
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="sidebar-toggle primary-toggle btn btn-sm" data-placement="right" data-toggle="tooltip" for="__primary" title="Toggle primary sidebar">
<span class="fa-solid fa-bars"></span>
</label>
</div>
<div class="header-article__right">
<div class="dropdown dropdown-launch-buttons">
<button aria-expanded="false" aria-label="Launch interactive content" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-rocket"></i>
</button>
<ul class="dropdown-menu">
</ul>
</div>
<button class="btn btn-sm" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="btn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="dropdown dropdown-repository-buttons">
<button aria-expanded="false" aria-label="Source repositories" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fab fa-github"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" href="https://github.com/neuromatch/course-content-template" target="_blank" title="Source repository">
<span class="btn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="btn__text-container">repository</span>
</a>

<li><a class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" href="https://github.com/neuromatch/course-content-template/issues/new?title=Issue%20on%20page%20%2Ftutorials/Bonus_BonusContent/student/Bonus_Tutorial3.html&amp;body=Your%20issue%20content%20here." target="_blank" title="Open an issue">
<span class="btn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="btn__text-container">open issue</span>
</a>

</li></li></ul>
</div>
<div class="dropdown dropdown-download-buttons">
<button aria-expanded="false" aria-label="Download this page" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-download"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/Bonus_BonusContent/student/Bonus_Tutorial3.ipynb" target="_blank" title="Download source file">
<span class="btn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="btn__text-container">.ipynb</span>
</a>

<li>
<button class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="btn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="btn__text-container">.pdf</span>
</button>

</li></li></ul>
</div>
<label class="sidebar-toggle secondary-toggle btn btn-sm" data-placement="left" data-toggle="tooltip" for="__secondary" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</label>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 3: Autoencoders applications</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 3: Autoencoders applications
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#autoencoder-applications">
     Autoencoder applications
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-0-introduction">
   Section 0: introduction
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-applications">
     Video 1: Applications
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-download-and-prepare-mnist-dataset">
   Section 1: Download  and prepare MNIST dataset
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-download-a-pre-trained-model">
   Section 2: Download a pre-trained model
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-applications-of-autoencoders">
   Section 3: Applications of autoencoders
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-1-image-noise">
     Application 1 - Image noise
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#reconstructions-before-fine-tuning">
       Reconstructions before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#latent-space-before-fine-tuning">
       Latent space before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#fine-tuning-the-autoencoder-with-noisy-images">
       Fine-tuning the autoencoder with noisy images
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#global-latent-space-shift">
       Global latent space shift
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-2-image-occlusion">
     Application 2 - Image occlusion
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#before-fine-tuning">
       Before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#after-fine-tuning">
       After fine-tuning
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-3-image-rotation">
     Application 3 - Image rotation
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
       After fine-tuning
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-4-what-would-digit-6-look-like-if-we-had-never-seen-it-before">
     Application 4 - What would digit “6” look like if we had never seen it before?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-removing-the-most-dominant-digit-classes">
       Coding Exercise 1: Removing the most dominant digit classes
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-anns-same-but-different">
   Section 4: ANNs? Same but different!
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-wrap-up">
     Video 2: Wrap-up
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
     Submit your feedback
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<article class="bd-article" role="main">
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/main/tutorials/Bonus_Autoencoders/Bonus_Tutorial3.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/tutorials/Bonus_Autoencoders/Bonus_Tutorial3.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="tutorial-3-autoencoders-applications">
<h1>Tutorial 3: Autoencoders applications<a class="headerlink" href="#tutorial-3-autoencoders-applications" title="Permalink to this heading">#</a></h1>
<p><strong>Bonus Day: Autoencoders</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Marco Brigham and the <a class="reference external" href="https://www.ccnss.org/">CCNSS</a> team (2014-2018)</p>
<p><strong>Content reviewers:</strong> Itzel Olivos, Karen Schroeder, Karolina Stosio, Kshitij Dwivedi, Spiros Chavlis, Michael Waskom</p>
<p><strong>Production editor:</strong> Spiros Chavlis</p>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this heading">#</a></h1>
<section id="autoencoder-applications">
<h2>Autoencoder applications<a class="headerlink" href="#autoencoder-applications" title="Permalink to this heading">#</a></h2>
<p>How do autoencoders with rich internal representations perform on the MNIST cognitive task?</p>
<p>How do autoencoders perceive unseen digit classes?</p>
<p>How does ANN image encoding differ from human vision?</p>
<p>We are equipped with tools and techniques to answer these questions, and hopefully, many others you may encounter in your research!</p>
<br/>
<p><img alt="MNIST cognitive task" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/mnist_task.png"/></p>
<br/>
<p>In this tutorial, you will:</p>
<ul class="simple">
<li><p>Analyze how autoencoders perceive transformed data (added noise, occluded parts, and rotations), and how that evolves with short re-train sessions</p></li>
<li><p>Use autoencoders to visualize unseen digit classes</p></li>
<li><p>Understand visual encoding for fully connected ANN autoencoders</p></li>
</ul>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h1>
<section id="install-and-import-feedback-gadget">
<h2>Install and import feedback gadget<a class="headerlink" href="#install-and-import-feedback-gadget" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install and import feedback gadget</span>

<span class="o">!</span>pip3<span class="w"> </span>install<span class="w"> </span>vibecheck<span class="w"> </span>datatops<span class="w"> </span>--quiet

<span class="kn">from</span> <span class="nn">vibecheck</span> <span class="kn">import</span> <span class="n">DatatopsContentReviewContainer</span>
<span class="k">def</span> <span class="nf">content_review</span><span class="p">(</span><span class="n">notebook_section</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DatatopsContentReviewContainer</span><span class="p">(</span>
        <span class="s2">""</span><span class="p">,</span>  <span class="c1"># No text prompt</span>
        <span class="n">notebook_section</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"https://pmyvdlilci.execute-api.us-east-1.amazonaws.com/klab"</span><span class="p">,</span>
            <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"neuromatch_cn"</span><span class="p">,</span>
            <span class="s2">"user_key"</span><span class="p">:</span> <span class="s2">"y1x3mpx5"</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>


<span class="n">feedback_prefix</span> <span class="o">=</span> <span class="s2">"Bonus_Autoencoders_T3"</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">ndimage</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">optim</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="figure-settings">
<h2>Figure settings<a class="headerlink" href="#figure-settings" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure settings</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">'matplotlib.font_manager'</span><span class="p">)</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content/NMA2020/nma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>


<span class="k">def</span> <span class="nf">downloadMNIST</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Download MNIST dataset and transform it to torch.Tensor</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    x_train : training images (torch.Tensor) (60000, 28, 28)</span>
<span class="sd">    x_test  : test images (torch.Tensor) (10000, 28, 28)</span>
<span class="sd">    y_train : training labels (torch.Tensor) (60000, )</span>
<span class="sd">    y_train : test labels (torch.Tensor) (10000, )</span>
<span class="sd">  """</span>
  <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s1">'mnist_784'</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="c1"># Trunk the data</span>
  <span class="n">n_train</span> <span class="o">=</span> <span class="mi">60000</span>
  <span class="n">n_test</span> <span class="o">=</span> <span class="mi">10000</span>

  <span class="n">train_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_train</span><span class="p">)</span>
  <span class="n">test_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_train</span><span class="p">,</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">)</span>

  <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span>
  <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">test_idx</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">test_idx</span><span class="p">]</span>

  <span class="c1"># Transform np.ndarrays to torch.Tensor</span>
  <span class="n">x_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span>
                                        <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">),</span>
                                         <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
  <span class="n">x_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span>
                                       <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span>
                                        <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>

  <span class="n">y_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
  <span class="n">y_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>

  <span class="k">return</span> <span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">init_weights_kaiming_uniform</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Initializes weights from linear PyTorch layer</span>
<span class="sd">  with kaiming uniform distribution.</span>

<span class="sd">  Args:</span>
<span class="sd">    layer (torch.Module)</span>
<span class="sd">        Pytorch layer</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>
  <span class="c1"># check for linear PyTorch layer</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">):</span>
    <span class="c1"># initialize weights with kaiming uniform distribution</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">kaiming_uniform_</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">init_weights_kaiming_normal</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Initializes weights from linear PyTorch layer</span>
<span class="sd">  with kaiming normal distribution.</span>

<span class="sd">  Args:</span>
<span class="sd">    layer (torch.Module)</span>
<span class="sd">        Pytorch layer</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>
  <span class="c1"># check for linear PyTorch layer</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">):</span>
    <span class="c1"># initialize weights with kaiming normal distribution</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">kaiming_normal_</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_layer_weights</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Retrieves learnable parameters from PyTorch layer.</span>

<span class="sd">  Args:</span>
<span class="sd">    layer (torch.Module)</span>
<span class="sd">        Pytorch layer</span>

<span class="sd">  Returns:</span>
<span class="sd">    list with learnable parameters</span>
<span class="sd">  """</span>
  <span class="c1"># initialize output list</span>
  <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="c1"># check whether layer has learnable parameters</span>
  <span class="k">if</span> <span class="n">layer</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
    <span class="c1"># copy numpy array representation of each set of learnable parameters</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
      <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

  <span class="k">return</span> <span class="n">weights</span>


<span class="k">def</span> <span class="nf">eval_mse</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Evaluates mean square error (MSE) between y_pred and y_true</span>

<span class="sd">  Args:</span>
<span class="sd">    y_pred (torch.Tensor)</span>
<span class="sd">        prediction samples</span>

<span class="sd">    v (numpy array of floats)</span>
<span class="sd">        ground truth samples</span>

<span class="sd">  Returns:</span>
<span class="sd">    MSE(y_pred, y_true)</span>
<span class="sd">  """</span>

  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>

  <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">eval_bce</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Evaluates binary cross-entropy (BCE) between y_pred and y_true</span>

<span class="sd">  Args:</span>
<span class="sd">    y_pred (torch.Tensor)</span>
<span class="sd">        prediction samples</span>

<span class="sd">    v (numpy array of floats)</span>
<span class="sd">        ground truth samples</span>

<span class="sd">  Returns:</span>
<span class="sd">    BCE(y_pred, y_true)</span>
<span class="sd">  """</span>

  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">()</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>

  <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_row</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">show_n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots rows of images from list of iterables (iterables: list, numpy array</span>
<span class="sd">  or torch.Tensor). Also accepts single iterable.</span>
<span class="sd">  Randomly selects images in each list element if item count &gt; show_n.</span>

<span class="sd">  Args:</span>
<span class="sd">    images (iterable or list of iterables)</span>
<span class="sd">        single iterable with images, or list of iterables</span>

<span class="sd">    show_n (integer)</span>
<span class="sd">        maximum number of images per row</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image if vectorized form</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
    <span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">images</span><span class="p">]</span>

  <span class="k">for</span> <span class="n">items_idx</span><span class="p">,</span> <span class="n">items</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>

    <span class="n">items</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">items</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">items</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show_n</span><span class="p">:</span>
      <span class="n">selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">show_n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
      <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">image_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">image_shape</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">image_idx</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>

      <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">image_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">to_s2</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Projects 3D coordinates to spherical coordinates (theta, phi) surface of</span>
<span class="sd">  unit sphere S2.</span>
<span class="sd">  theta: [0, pi]</span>
<span class="sd">  phi: [-pi, pi]</span>

<span class="sd">  Args:</span>
<span class="sd">    u (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        3D coordinates</span>

<span class="sd">  Returns:</span>
<span class="sd">    Sperical coordinates (theta, phi) on surface of unit sphere S2.</span>
<span class="sd">  """</span>

  <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span>
  <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>


<span class="k">def</span> <span class="nf">to_u3</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Converts from 2D coordinates on surface of unit sphere S2 to 3D coordinates</span>
<span class="sd">  (on surface of S2), i.e. (theta, phi) ---&gt; (1, theta, phi).</span>

<span class="sd">  Args:</span>
<span class="sd">    s (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D coordinates on unit sphere S_2</span>

<span class="sd">  Returns:</span>
<span class="sd">    3D coordinates on surface of unit sphere S_2</span>
<span class="sd">  """</span>

  <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>


<span class="k">def</span> <span class="nf">xy_lim</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Return arguments for plt.xlim and plt.ylim calculated from minimum</span>
<span class="sd">  and maximum of x.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        data to be plotted</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>
  <span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="n">x_min</span> <span class="o">=</span> <span class="n">x_min</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
  <span class="n">x_max</span> <span class="o">=</span> <span class="n">x_max</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>

  <span class="k">return</span> <span class="p">[</span><span class="n">x_min</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_max</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">x_min</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>


<span class="k">def</span> <span class="nf">plot_generative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">decoder_fn</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">,</span> <span class="n">n_row</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots images reconstructed by decoder_fn from a 2D grid in</span>
<span class="sd">  latent space that is determined by minimum and maximum values in x.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D or 3D coordinates in latent space</span>

<span class="sd">    decoder_fn (integer)</span>
<span class="sd">        function returning vectorized images from 2D latent space coordinates</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image</span>

<span class="sd">    n_row (integer)</span>
<span class="sd">        number of rows in grid</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        convert 3D coordinates (x, y, z) to spherical coordinates (theta, phi)</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">to_s2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

  <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">xy_lim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

  <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">n_row</span>
  <span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_row</span><span class="p">),</span>
          <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_row</span><span class="p">)]</span>

  <span class="n">canvas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_row</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_row</span><span class="p">))</span>

  <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'gray'</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">latent_y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">latent_x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>

      <span class="n">latent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">latent_x</span><span class="p">,</span> <span class="n">latent_y</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
        <span class="n">latent</span> <span class="o">=</span> <span class="n">to_u3</span><span class="p">(</span><span class="n">latent</span><span class="p">)</span>

      <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">x_decoded</span> <span class="o">=</span> <span class="n">decoder_fn</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">latent</span><span class="p">))</span>

      <span class="n">x_decoded</span> <span class="o">=</span> <span class="n">x_decoded</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image_shape</span><span class="p">)</span>

      <span class="n">canvas</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
             <span class="n">i</span> <span class="o">*</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">x_decoded</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_latent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">show_n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xy_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots digit class of each sample in 2D latent space coordinates.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D coordinates in latent space</span>

<span class="sd">    y (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        digit class of each sample</span>

<span class="sd">    n_row (integer)</span>
<span class="sd">        number of samples</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        convert 3D coordinates (x, y, z) to spherical coordinates (theta, phi)</span>

<span class="sd">    fontdict (dictionary)</span>
<span class="sd">        style option for plt.text</span>

<span class="sd">    xy_labels (list)</span>
<span class="sd">        optional list with [xlabel, ylabel]</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="n">fontdict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'weight'</span><span class="p">:</span> <span class="s1">'bold'</span><span class="p">,</span> <span class="s1">'size'</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>

  <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">to_s2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

  <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'tab10'</span><span class="p">)</span>

  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show_n</span><span class="p">:</span>
    <span class="n">selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">show_n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>

  <span class="k">for</span> <span class="n">my_x</span><span class="p">,</span> <span class="n">my_y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">my_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">my_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">my_y</span><span class="p">)),</span>
             <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">my_y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.</span><span class="p">),</span>
             <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">,</span>
             <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span>
             <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span>
             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

  <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">xy_lim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">xy_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">xy_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">'$\varphi$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\theta$'</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">6</span><span class="p">),</span>
               <span class="p">[</span><span class="s1">'0'</span><span class="p">,</span> <span class="s1">'$\pi/6$'</span><span class="p">,</span> <span class="s1">'$\pi/3$'</span><span class="p">,</span> <span class="s1">'$\pi/2$'</span><span class="p">,</span>
                <span class="s1">'$2\pi/3$'</span><span class="p">,</span> <span class="s1">'$5\pi/6$'</span><span class="p">,</span> <span class="s1">'$\pi$'</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span>
               <span class="p">[</span><span class="s1">'$-\pi$'</span><span class="p">,</span> <span class="s1">'$-2\pi/3$'</span><span class="p">,</span> <span class="s1">'$-\pi/3$'</span><span class="p">,</span> <span class="s1">'0'</span><span class="p">,</span>
                <span class="s1">'$\pi/3$'</span><span class="p">,</span> <span class="s1">'$2\pi/3$'</span><span class="p">,</span> <span class="s1">'$\pi$'</span><span class="p">])</span>

  <span class="k">if</span> <span class="n">xy_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xy_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'$Z_1$'</span><span class="p">,</span> <span class="s1">'$Z_2$'</span><span class="p">]</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xy_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">xy_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">plot_latent_generative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">decoder_fn</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xy_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Two horizontal subplots generated with encoder map and decoder grid.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D coordinates in latent space</span>

<span class="sd">    y (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        digit class of each sample</span>

<span class="sd">    decoder_fn (integer)</span>
<span class="sd">        function returning vectorized images from 2D latent space coordinates</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        convert 3D coordinates (x, y, z) to spherical coordinates (theta, phi)</span>

<span class="sd">    title (string)</span>
<span class="sd">        plot title</span>

<span class="sd">    xy_labels (list)</span>
<span class="sd">        optional list with [xlabel, ylabel]</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

  <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>

  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Encoder map'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plot_latent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">xy_labels</span><span class="o">=</span><span class="n">xy_labels</span><span class="p">)</span>

  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Decoder grid'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plot_generative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">decoder_fn</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_latent_ab</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">selected_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before'</span><span class="p">,</span> <span class="n">title_b</span><span class="o">=</span><span class="s1">'After'</span><span class="p">,</span> <span class="n">show_n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Two horizontal subplots with encoder maps.</span>

<span class="sd">  Args:</span>
<span class="sd">    x1 (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D coordinates in latent space (left plot)</span>

<span class="sd">    x2 (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        digit class of each sample (right plot)</span>

<span class="sd">    y (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        digit class of each sample</span>

<span class="sd">    selected_idx (list of integers)</span>
<span class="sd">        indexes of elements to be plotted</span>

<span class="sd">    show_n (integer)</span>
<span class="sd">        maximum number of samples in each plot</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        convert 3D coordinates (x, y, z) to spherical coordinates (theta, phi)</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'weight'</span><span class="p">:</span> <span class="s1">'bold'</span><span class="p">,</span> <span class="s1">'size'</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>

  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show_n</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">selected_idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">selected_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">show_n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span>

  <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>

  <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
    <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">xy_lim</span><span class="p">(</span><span class="n">to_s2</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">xy_lim</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plot_latent</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_b</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plot_latent</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">runSGD</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">input_train</span><span class="p">,</span> <span class="n">input_test</span><span class="p">,</span> <span class="n">out_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">'bce'</span><span class="p">,</span> <span class="n">n_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
           <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Trains autoencoder network with stochastic gradient descent with</span>
<span class="sd">  optimizer and loss criterion. Train samples are shuffled, and loss is</span>
<span class="sd">  displayed at the end of each opoch for both MSE and BCE. Plots training loss</span>
<span class="sd">  at each minibatch (maximum of 500 randomly selected values).</span>

<span class="sd">  Args:</span>
<span class="sd">    net (torch network)</span>
<span class="sd">        ANN network (nn.Module)</span>

<span class="sd">    input_train (torch.Tensor)</span>
<span class="sd">        vectorized input images from train set</span>

<span class="sd">    input_test (torch.Tensor)</span>
<span class="sd">        vectorized input images from test set</span>

<span class="sd">    criterion (string)</span>
<span class="sd">        train loss: 'bce' or 'mse'</span>

<span class="sd">    out_train (torch.Tensor)</span>
<span class="sd">        optional target images from train set</span>

<span class="sd">    out_test (torch.Tensor)</span>
<span class="sd">        optional target images from test set</span>

<span class="sd">    optimizer (torch optimizer)</span>
<span class="sd">        optional target images from train set</span>

<span class="sd">    criterion (string)</span>
<span class="sd">        train loss: 'bce' or 'mse'</span>

<span class="sd">    n_epochs (boolean)</span>
<span class="sd">        number of full iterations of training data</span>

<span class="sd">    batch_size (integer)</span>
<span class="sd">        number of element in mini-batches</span>

<span class="sd">    verbose (boolean)</span>
<span class="sd">        whether to print final loss</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="n">out_train</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">out_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">different_output</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">different_output</span> <span class="o">=</span> <span class="kc">False</span>

  <span class="c1"># Initialize loss function</span>
  <span class="k">if</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">'mse'</span><span class="p">:</span>
    <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
  <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">'bce'</span><span class="p">:</span>
    <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Please specify either "mse" or "bce" for loss criterion'</span><span class="p">)</span>

  <span class="c1"># Initialize SGD optimizer</span>
  <span class="k">if</span> <span class="n">optimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

  <span class="c1"># Placeholder for loss</span>
  <span class="n">track_loss</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">'Epoch'</span><span class="p">,</span> <span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'Loss train'</span><span class="p">,</span> <span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'Loss test'</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>

    <span class="n">shuffle_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_train</span><span class="p">))</span>
    <span class="n">batches</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">input_train</span><span class="p">[</span><span class="n">shuffle_idx</span><span class="p">],</span> <span class="n">batch_size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
      <span class="n">batches_out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">out_train</span><span class="p">[</span><span class="n">shuffle_idx</span><span class="p">],</span> <span class="n">batch_size</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batches</span><span class="p">):</span>

      <span class="n">output_train</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span> <span class="n">batches_out</span><span class="p">[</span><span class="n">batch_idx</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>

      <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
      <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
      <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

      <span class="c1"># Keep track of loss at each epoch</span>
      <span class="n">track_loss</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="p">)]</span>

    <span class="n">loss_epoch</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">n_epochs</span><span class="si">}</span><span class="s1">'</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
      <span class="n">output_train</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">input_train</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
        <span class="n">loss_train</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span> <span class="n">out_train</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">loss_train</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span> <span class="n">input_train</span><span class="p">)</span>

      <span class="n">loss_epoch</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">loss_train</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">'</span>

      <span class="n">output_test</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
        <span class="n">loss_test</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span> <span class="n">out_test</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">loss_test</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span> <span class="n">input_test</span><span class="p">)</span>

      <span class="n">loss_epoch</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">loss_test</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">'</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">loss_epoch</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
    <span class="c1"># Print loss</span>
    <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
      <span class="n">loss_mse</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">MSE</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_mse</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span><span class="w"> </span><span class="n">out_train</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
      <span class="n">loss_mse</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_mse</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span><span class="w"> </span><span class="n">out_test</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">loss_mse</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">MSE</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_mse</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span><span class="w"> </span><span class="n">input_train</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
      <span class="n">loss_mse</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_mse</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span><span class="w"> </span><span class="n">input_test</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">loss_mse</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
      <span class="n">loss_bce</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'BCE</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_bce</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span><span class="w"> </span><span class="n">out_train</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
      <span class="n">loss_bce</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_bce</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span><span class="w"> </span><span class="n">out_test</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">loss_bce</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'BCE</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_bce</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span><span class="w"> </span><span class="n">input_train</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
      <span class="n">loss_bce</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_bce</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span><span class="w"> </span><span class="n">input_test</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">loss_bce</span><span class="p">)</span>

  <span class="c1"># Plot loss</span>
  <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">track_loss</span><span class="p">)</span><span class="o">/</span><span class="mi">500</span><span class="p">))</span>
  <span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">track_loss</span><span class="p">),</span> <span class="n">step</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">track_loss</span><span class="p">[::</span><span class="n">step</span><span class="p">],</span> <span class="s1">'C0'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Iterations'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">image_occlusion</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Randomly selects on quadrant of images and sets to zeros.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (torch.Tensor of floats)</span>
<span class="sd">        vectorized images</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image</span>

<span class="sd">  Returns:</span>
<span class="sd">    torch.Tensor.</span>
<span class="sd">  """</span>

  <span class="n">selection</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

  <span class="n">my_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">my_x</span> <span class="o">=</span> <span class="n">my_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

  <span class="n">my_x</span><span class="p">[</span><span class="n">selection</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">my_x</span><span class="p">[</span><span class="n">selection</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):,</span> <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">my_x</span><span class="p">[</span><span class="n">selection</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">my_x</span><span class="p">[</span><span class="n">selection</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):,</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):]</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="n">my_x</span> <span class="o">=</span> <span class="n">my_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">my_x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">image_rotation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Randomly rotates images by +- deg degrees.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (torch.Tensor of floats)</span>
<span class="sd">        vectorized images</span>

<span class="sd">    deg (integer)</span>
<span class="sd">        rotation range</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image</span>

<span class="sd">  Returns:</span>
<span class="sd">    torch.Tensor.</span>
<span class="sd">  """</span>

  <span class="n">my_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">my_x</span> <span class="o">=</span> <span class="n">my_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

  <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">my_x</span><span class="p">):</span>
    <span class="n">my_deg</span> <span class="o">=</span> <span class="n">deg</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">-</span> <span class="n">deg</span>
    <span class="n">my_x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">my_x</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">my_deg</span><span class="p">,</span>
                               <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefilter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

  <span class="n">my_x</span> <span class="o">=</span> <span class="n">my_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">my_x</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">AutoencoderClass</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Deep autoencoder network object (nn.Module) with optional L2 normalization</span>
<span class="sd">  of activations in bottleneck layer.</span>

<span class="sd">  Args:</span>
<span class="sd">    input_size (integer)</span>
<span class="sd">        size of input samples</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        whether to L2 normalize activatinos in bottleneck layer</span>

<span class="sd">  Returns:</span>
<span class="sd">    Autoencoder object inherited from nn.Module class.</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="o">=</span><span class="mi">784</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">=</span> <span class="n">input_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span>

    <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">enc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc1_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc2_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">*</span> <span class="mi">32</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc3_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec1_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">*</span> <span class="mi">32</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec2_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_size</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec3_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">encoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Encoder component.</span>
<span class="sd">    """</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc1_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc2_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc3_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enc3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>

  <span class="k">def</span> <span class="nf">decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Decoder component.</span>
<span class="sd">    """</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec1_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec2_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec3_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">x</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Forward pass.</span>
<span class="sd">    """</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">save_checkpoint</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Saves a PyTorch checkpoint.</span>

<span class="sd">  Args:</span>
<span class="sd">    net (torch network)</span>
<span class="sd">        ANN network (nn.Module)</span>

<span class="sd">    optimizer (torch optimizer)</span>
<span class="sd">        optimizer for SGD</span>

<span class="sd">    filename (string)</span>
<span class="sd">        filename (without extension)</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">({</span><span class="s1">'model_state_dict'</span><span class="p">:</span> <span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
              <span class="s1">'optimizer_state_dict'</span><span class="p">:</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()},</span>
             <span class="n">filename</span><span class="o">+</span><span class="s1">'.pt'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">load_checkpoint</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Loads a PyTorch checkpoint from URL is local file not present.</span>

<span class="sd">  Args:</span>
<span class="sd">    url (string)</span>
<span class="sd">        URL location of PyTorch checkpoint</span>

<span class="sd">    filename (string)</span>
<span class="sd">        filename (without extension)</span>

<span class="sd">  Returns:</span>
<span class="sd">    PyTorch checkpoint of saved model.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">'.pt'</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">"wget </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">.pt"</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">'.pt'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">reset_checkpoint</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Resets PyTorch model to checkpoint.</span>

<span class="sd">  Args:</span>
<span class="sd">    net (torch network)</span>
<span class="sd">        ANN network (nn.Module)</span>

<span class="sd">    optimizer (torch optimizer)</span>
<span class="sd">        optimizer for SGD</span>

<span class="sd">    checkpoint (torch checkpoint)</span>
<span class="sd">        checkpoint of saved model</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="n">net</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'model_state_dict'</span><span class="p">])</span>
  <span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'optimizer_state_dict'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-0-introduction">
<h1>Section 0: introduction<a class="headerlink" href="#section-0-introduction" title="Permalink to this heading">#</a></h1>
<section id="video-1-applications">
<h2>Video 1: Applications<a class="headerlink" href="#video-1-applications" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "26aadc80271544a48d6c0850d08a0250"}</script></div>
</div>
</section>
<section id="submit-your-feedback">
<h2>Submit your feedback<a class="headerlink" href="#submit-your-feedback" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Applications_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "becb4bafdbfd4ecbb251a94e34d7c0eb"}</script></div>
</div>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-1-download-and-prepare-mnist-dataset">
<h1>Section 1: Download  and prepare MNIST dataset<a class="headerlink" href="#section-1-download-and-prepare-mnist-dataset" title="Permalink to this heading">#</a></h1>
<p>We use the helper function <code class="docutils literal notranslate"><span class="pre">downloadMNIST</span></code> to download the dataset and transform it into <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code> and assign train and test sets to (<code class="docutils literal notranslate"><span class="pre">x_train</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code>) and (<code class="docutils literal notranslate"><span class="pre">x_test</span></code>, <code class="docutils literal notranslate"><span class="pre">y_test</span></code>).</p>
<p>The variable <code class="docutils literal notranslate"><span class="pre">input_size</span></code> stores the length of <em>vectorized</em> versions of the images <code class="docutils literal notranslate"><span class="pre">input_train</span></code> and <code class="docutils literal notranslate"><span class="pre">input_test</span></code> for training and test images.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download MNIST</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">downloadMNIST</span><span class="p">()</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span> <span class="o">/</span> <span class="mi">255</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span> <span class="o">/</span> <span class="mi">255</span>

<span class="n">image_shape</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">input_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">input_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_size</span><span class="p">])</span>
<span class="n">input_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_size</span><span class="p">])</span>

<span class="n">test_selected_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">train_selected_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">test_subset_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span> <span class="mi">500</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'shape image </span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">image_shape</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'shape input_train </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">input_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'shape input_test </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">input_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape image 		 torch.Size([28, 28])
shape input_train 	 torch.Size([60000, 784])
shape input_test 	 torch.Size([10000, 784])
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-2-download-a-pre-trained-model">
<h1>Section 2: Download a pre-trained model<a class="headerlink" href="#section-2-download-a-pre-trained-model" title="Permalink to this heading">#</a></h1>
<p>The class <code class="docutils literal notranslate"><span class="pre">AutoencoderClass</span></code> implements the autoencoder architectures introduced in the previous tutorial. The design of this class follows the object-oriented programming (OOP) style from tutorial W3D4. Setting the boolean parameter <code class="docutils literal notranslate"><span class="pre">s2=True</span></code> specifies the model with projection onto the <span class="math notranslate nohighlight">\(S_2\)</span> sphere.</p>
<p>We trained both models for <code class="docutils literal notranslate"><span class="pre">n_epochs=25</span></code> and saved the weights to avoid a lengthy initial training period - these will be our reference model states.</p>
<p>Experiments are run from the identical initial conditions by resetting the autoencoder to the reference state at the beginning of each exercise.</p>
<p>The mechanism for loading and storing models from PyTorch is the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">()</span>
</pre></div>
</div>
<p>and then</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">({</span><span class="s1">'model_state_dict'</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
            <span class="s1">'optimizer_state_dict'</span><span class="p">:</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()},</span>
           <span class="n">filename_path</span><span class="p">)</span>

<span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename_path</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'model_state_dict'</span><span class="p">])</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'optimizer_state_dict'</span><span class="p">])</span>
</pre></div>
</div>
<p>See additional <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/saving_and_loading_a_general_checkpoint.html">PyTorch instructions</a>, and when to use <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> and <code class="docutils literal notranslate"><span class="pre">model.train()</span></code> for more complex models.</p>
<p>We provide the functions <code class="docutils literal notranslate"><span class="pre">save_checkpoint</span></code>, <code class="docutils literal notranslate"><span class="pre">load_checkpoint</span></code>, and <code class="docutils literal notranslate"><span class="pre">reset_checkpoint</span></code> to implement the steps above and download pre-trained weights from the GitHub repo.</p>
<p>If downloading from GitHub fails, please uncomment the 3rd cell bellow to train the model for <code class="docutils literal notranslate"><span class="pre">n_epochs=10</span></code> and save it locally.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="s1">'https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders'</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">'ae_6h_prelu_bce_adam_25e_32b'</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
  <span class="n">filename</span> <span class="o">+=</span> <span class="s1">'_s2'</span>
  <span class="n">url</span> <span class="o">+=</span> <span class="s1">'_s2'</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">(</span><span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span>

<span class="n">checkpoint</span> <span class="o">=</span> <span class="n">load_checkpoint</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'model_state_dict'</span><span class="p">])</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'optimizer_state_dict'</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2024-01-26 16:01:45--  https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/ae_6h_prelu_bce_adam_25e_32b_s2.pt
Resolving github.com (github.com)... 192.30.255.112
Connecting to github.com (github.com)|192.30.255.112|:443... connected.
HTTP request sent, awaiting response... 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>302 Found
Location: https://raw.githubusercontent.com/mpbrigham/colaboratory-figures/master/nma/autoencoders/ae_6h_prelu_bce_adam_25e_32b_s2.pt [following]
--2024-01-26 16:01:45--  https://raw.githubusercontent.com/mpbrigham/colaboratory-figures/master/nma/autoencoders/ae_6h_prelu_bce_adam_25e_32b_s2.pt
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.109.133, 185.199.111.133, 185.199.110.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.109.133|:443... connected.
HTTP request sent, awaiting response... 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200 OK
Length: 8313616 (7.9M) [application/octet-stream]
Saving to: ‘ae_6h_prelu_bce_adam_25e_32b_s2.pt’

     0K .......... .......... .......... .......... ..........  0% 7.77M 1s
    50K .......... .......... .......... .......... ..........  1% 31.5M 1s
   100K .......... .......... .......... .......... ..........  1% 12.5M 1s
   150K .......... .......... .......... .......... ..........  2% 32.7M 1s
   200K .......... .......... .......... .......... ..........  3% 8.11M 1s
   250K .......... .......... .......... .......... ..........  3%  164M 1s
   300K .......... .......... .......... .......... ..........  4% 41.6M 0s
   350K .......... .......... .......... .......... ..........  4% 34.9M 0s
   400K .......... .......... .......... .......... ..........  5% 44.3M 0s
   450K .......... .......... .......... .......... ..........  6% 32.8M 0s
   500K .......... .......... .......... .......... ..........  6% 45.6M 0s
   550K .......... .......... .......... .......... ..........  7%  160M 0s
   600K .......... .......... .......... .......... ..........  8% 48.0M 0s
   650K .......... .......... .......... .......... ..........  8% 55.4M 0s
   700K .......... .......... .......... .......... ..........  9% 77.6M 0s
   750K .......... .......... .......... .......... ..........  9% 55.6M 0s
   800K .......... .......... .......... .......... .......... 10% 68.4M 0s
   850K .......... .......... .......... .......... .......... 11% 56.3M 0s
   900K .......... .......... .......... .......... .......... 11% 61.7M 0s
   950K .......... .......... .......... .......... .......... 12% 91.5M 0s
  1000K .......... .......... .......... .......... .......... 12% 41.8M 0s
  1050K .......... .......... .......... .......... .......... 13%  144M 0s
  1100K .......... .......... .......... .......... .......... 14% 44.8M 0s
  1150K .......... .......... .......... .......... .......... 14% 78.9M 0s
  1200K .......... .......... .......... .......... .......... 15%  206M 0s
  1250K .......... .......... .......... .......... .......... 16% 40.6M 0s
  1300K .......... .......... .......... .......... .......... 16%  112M 0s
  1350K .......... .......... .......... .......... .......... 17% 50.3M 0s
  1400K .......... .......... .......... .......... .......... 17%  131M 0s
  1450K .......... .......... .......... .......... .......... 18%  126M 0s
  1500K .......... .......... .......... .......... .......... 19% 58.0M 0s
  1550K .......... .......... .......... .......... .......... 19%  139M 0s
  1600K .......... .......... .......... .......... .......... 20% 51.8M 0s
  1650K .......... .......... .......... .......... .......... 20% 85.7M 0s
  1700K .......... .......... .......... .......... .......... 21%  217M 0s
  1750K .......... .......... .......... .......... .......... 22% 40.5M 0s
  1800K .......... .......... .......... .......... .......... 22%  151M 0s
  1850K .......... .......... .......... .......... .......... 23% 70.3M 0s
  1900K .......... .......... .......... .......... .......... 24% 94.5M 0s
  1950K .......... .......... .......... .......... .......... 24% 62.3M 0s
  2000K .......... .......... .......... .......... .......... 25% 76.0M 0s
  2050K .......... .......... .......... .......... .......... 25%  237M 0s
  2100K .......... .......... .......... .......... .......... 26% 66.6M 0s
  2150K .......... .......... .......... .......... .......... 27% 89.8M 0s
  2200K .......... .......... .......... .......... .......... 27%  234M 0s
  2250K .......... .......... .......... .......... .......... 28%  243M 0s
  2300K .......... .......... .......... .......... .......... 28% 41.8M 0s
  2350K .......... .......... .......... .......... .......... 29%  168M 0s
  2400K .......... .......... .......... .......... .......... 30%  140M 0s
  2450K .......... .......... .......... .......... .......... 30% 39.8M 0s
  2500K .......... .......... .......... .......... .......... 31%  197M 0s
  2550K .......... .......... .......... .......... .......... 32%  312M 0s
  2600K .......... .......... .......... .......... .......... 32%  152M 0s
  2650K .......... .......... .......... .......... .......... 33% 56.2M 0s
  2700K .......... .......... .......... .......... .......... 33%  158M 0s
  2750K .......... .......... .......... .......... .......... 34%  225M 0s
  2800K .......... .......... .......... .......... .......... 35%  172M 0s
  2850K .......... .......... .......... .......... .......... 35% 53.8M 0s
  2900K .......... .......... .......... .......... .......... 36%  177M 0s
  2950K .......... .......... .......... .......... .......... 36%  229M 0s
  3000K .......... .......... .......... .......... .......... 37%  198M 0s
  3050K .......... .......... .......... .......... .......... 38% 56.2M 0s
  3100K .......... .......... .......... .......... .......... 38%  157M 0s
  3150K .......... .......... .......... .......... .......... 39%  165M 0s
  3200K .......... .......... .......... .......... .......... 40%  236M 0s
  3250K .......... .......... .......... .......... .......... 40% 55.2M 0s
  3300K .......... .......... .......... .......... .......... 41%  134M 0s
  3350K .......... .......... .......... .......... .......... 41%  198M 0s
  3400K .......... .......... .......... .......... .......... 42%  176M 0s
  3450K .......... .......... .......... .......... .......... 43% 59.9M 0s
  3500K .......... .......... .......... .......... .......... 43%  206M 0s
  3550K .......... .......... .......... .......... .......... 44%  242M 0s
  3600K .......... .......... .......... .......... .......... 44%  210M 0s
  3650K .......... .......... .......... .......... .......... 45%  175M 0s
  3700K .......... .......... .......... .......... .......... 46% 61.6M 0s
  3750K .......... .......... .......... .......... .......... 46%  227M 0s
  3800K .......... .......... .......... .......... .......... 47%  156M 0s
  3850K .......... .......... .......... .......... .......... 48%  201M 0s
  3900K .......... .......... .......... .......... .......... 48%  186M 0s
  3950K .......... .......... .......... .......... .......... 49%  110M 0s
  4000K .......... .......... .......... .......... .......... 49%  190M 0s
  4050K .......... .......... .......... .......... .......... 50%  131M 0s
  4100K .......... .......... .......... .......... .......... 51%  208M 0s
  4150K .......... .......... .......... .......... .......... 51%  116M 0s
  4200K .......... .......... .......... .......... .......... 52%  198M 0s
  4250K .......... .......... .......... .......... .......... 52%  139M 0s
  4300K .......... .......... .......... .......... .......... 53%  223M 0s
  4350K .......... .......... .......... .......... .......... 54%  278M 0s
  4400K .......... .......... .......... .......... .......... 54%  118M 0s
  4450K .......... .......... .......... .......... .......... 55%  143M 0s
  4500K .......... .......... .......... .......... .......... 56%  195M 0s
  4550K .......... .......... .......... .......... .......... 56% 97.7M 0s
  4600K .......... .......... .......... .......... .......... 57%  211M 0s
  4650K .......... .......... .......... .......... .......... 57% 82.2M 0s
  4700K .......... .......... .......... .......... .......... 58%  205M 0s
  4750K .......... .......... .......... .......... .......... 59%  215M 0s
  4800K .......... .......... .......... .......... .......... 59%  184M 0s
  4850K .......... .......... .......... .......... .......... 60%  174M 0s
  4900K .......... .......... .......... .......... .......... 60% 74.4M 0s
  4950K .......... .......... .......... .......... .......... 61%  210M 0s
  5000K .......... .......... .......... .......... .......... 62%  272M 0s
  5050K .......... .......... .......... .......... .......... 62%  169M 0s
  5100K .......... .......... .......... .......... .......... 63%  214M 0s
  5150K .......... .......... .......... .......... .......... 64% 85.3M 0s
  5200K .......... .......... .......... .......... .......... 64%  223M 0s
  5250K .......... .......... .......... .......... .......... 65%  184M 0s
  5300K .......... .......... .......... .......... .......... 65%  212M 0s
  5350K .......... .......... .......... .......... .......... 66%  210M 0s
  5400K .......... .......... .......... .......... .......... 67%  209M 0s
  5450K .......... .......... .......... .......... .......... 67%  108M 0s
  5500K .......... .......... .......... .......... .......... 68%  147M 0s
  5550K .......... .......... .......... .......... .......... 68%  178M 0s
  5600K .......... .......... .......... .......... .......... 69%  202M 0s
  5650K .......... .......... .......... .......... .......... 70%  195M 0s
  5700K .......... .......... .......... .......... .......... 70%  226M 0s
  5750K .......... .......... .......... .......... .......... 71%  208M 0s
  5800K .......... .......... .......... .......... .......... 72%  187M 0s
  5850K .......... .......... .......... .......... .......... 72%  169M 0s
  5900K .......... .......... .......... .......... .......... 73%  208M 0s
  5950K .......... .......... .......... .......... .......... 73%  210M 0s
  6000K .......... .......... .......... .......... .......... 74%  211M 0s
  6050K .......... .......... .......... .......... .......... 75%  175M 0s
  6100K .......... .......... .......... .......... .......... 75%  184M 0s
  6150K .......... .......... .......... .......... .......... 76%  202M 0s
  6200K .......... .......... .......... .......... .......... 76%  196M 0s
  6250K .......... .......... .......... .......... .......... 77%  176M 0s
  6300K .......... .......... .......... .......... .......... 78%  210M 0s
  6350K .......... .......... .......... .......... .......... 78%  180M 0s
  6400K .......... .......... .......... .......... .......... 79%  216M 0s
  6450K .......... .......... .......... .......... .......... 80%  194M 0s
  6500K .......... .......... .......... .......... .......... 80%  221M 0s
  6550K .......... .......... .......... .......... .......... 81%  221M 0s
  6600K .......... .......... .......... .......... .......... 81%  196M 0s
  6650K .......... .......... .......... .......... .......... 82%  175M 0s
  6700K .......... .......... .......... .......... .......... 83%  193M 0s
  6750K .......... .......... .......... .......... .......... 83%  184M 0s
  6800K .......... .......... .......... .......... .......... 84%  191M 0s
  6850K .......... .......... .......... .......... .......... 84%  171M 0s
  6900K .......... .......... .......... .......... .......... 85%  223M 0s
  6950K .......... .......... .......... .......... .......... 86%  198M 0s
  7000K .......... .......... .......... .......... .......... 86%  204M 0s
  7050K .......... .......... .......... .......... .......... 87%  177M 0s
  7100K .......... .......... .......... .......... .......... 88%  178M 0s
  7150K .......... .......... .......... .......... .......... 88%  177M 0s
  7200K .......... .......... .......... .......... .......... 89%  194M 0s
  7250K .......... .......... .......... .......... .......... 89%  157M 0s
  7300K .......... .......... .......... .......... .......... 90%  187M 0s
  7350K .......... .......... .......... .......... .......... 91%  211M 0s
  7400K .......... .......... .......... .......... .......... 91%  222M 0s
  7450K .......... .......... .......... .......... .......... 92%  188M 0s
  7500K .......... .......... .......... .......... .......... 92%  215M 0s
  7550K .......... .......... .......... .......... .......... 93%  215M 0s
  7600K .......... .......... .......... .......... .......... 94%  214M 0s
  7650K .......... .......... .......... .......... .......... 94%  191M 0s
  7700K .......... .......... .......... .......... .......... 95%  189M 0s
  7750K .......... .......... .......... .......... .......... 96%  192M 0s
  7800K .......... .......... .......... .......... .......... 96%  204M 0s
  7850K .......... .......... .......... .......... .......... 97%  176M 0s
  7900K .......... .......... .......... .......... .......... 97%  226M 0s
  7950K .......... .......... .......... .......... .......... 98%  189M 0s
  8000K .......... .......... .......... .......... .......... 99%  224M 0s
  8050K .......... .......... .......... .......... .......... 99%  187M 0s
  8100K .......... ........                                   100%  236M=0.09s

2024-01-26 16:01:46 (92.9 MB/s) - ‘ae_6h_prelu_bce_adam_25e_32b_s2.pt’ saved [8313616/8313616]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Please uncomment and execute this cell if download if pre-trained weights fail</span>

<span class="c1"># model = AutoencoderClass(s2=s2)</span>
<span class="c1"># encoder = model.encoder</span>
<span class="c1"># decoder = model.decoder</span>
<span class="c1"># n_epochs = 10</span>
<span class="c1"># batch_size = 128</span>
<span class="c1"># runSGD(model, input_train, input_test,</span>
<span class="c1">#        n_epochs=n_epochs, batch_size=batch_size)</span>
<span class="c1"># save_checkpoint(model, optimizer, filename)</span>
<span class="c1"># checkpoint = load_checkpoint(url, filename)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
  <span class="n">latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span> <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_generative</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span>
                       <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/41dcd0324798aa9b95ffbbab238f6b1da80c0af51f4b8b5bfe1b7e742e5c06d1.png" src="../../../_images/41dcd0324798aa9b95ffbbab238f6b1da80c0af51f4b8b5bfe1b7e742e5c06d1.png">
<img alt="../../../_images/faf91425432685167626ec7b1b0ce8b36b1caec982d6c7c958a0d5a7175bd302.png" src="../../../_images/faf91425432685167626ec7b1b0ce8b36b1caec982d6c7c958a0d5a7175bd302.png"/>
<img alt="../../../_images/1771d7024d3b61cbefc55c9c6dcef7a31dc0c9750696b2d803dd04401b96e356.png" src="../../../_images/1771d7024d3b61cbefc55c9c6dcef7a31dc0c9750696b2d803dd04401b96e356.png"/>
</img></div>
</div>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-3-applications-of-autoencoders">
<h1>Section 3: Applications of autoencoders<a class="headerlink" href="#section-3-applications-of-autoencoders" title="Permalink to this heading">#</a></h1>
<section id="application-1-image-noise">
<h2>Application 1 - Image noise<a class="headerlink" href="#application-1-image-noise" title="Permalink to this heading">#</a></h2>
<p>Removing noise added to images is often showcased in dimensionality reduction techniques. The tutorial in <em>Dimensionality reduction</em> day illustrated this capability with PCA.</p>
<p>We first observe that autoencoders trained with noise-free images output noise-free images when receiving noisy images as input.  However, the reconstructed images will be different from the original images (without noise) since the added noise maps to different coordinates in latent space.</p>
<p>The ability to map noise-free and noisy versions to similar regions in latent space is known as <em>robustness</em> or <em>invariance</em> to noise. How can we build such functionality into the autoencoder?</p>
<p>The solution is to train the autoencoder with noise-free and noisy versions mapping to the noise-free version. A faster alternative is to re-train the autoencoder for few epochs with noisy images. These short training sessions fine-tune the weights to map noisy images to their noise-free versions from similar latent space coordinates.</p>
<p>Let’s start by resetting to the reference state of the autoencoder.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cells below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset_checkpoint</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test_ref</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="reconstructions-before-fine-tuning">
<h3>Reconstructions before fine-tuning<a class="headerlink" href="#reconstructions-before-fine-tuning" title="Permalink to this heading">#</a></h3>
<p>Let’s verify that an autoencoder trained on clean images will output clean images from noisy inputs. We visualize this by plotting three rows:</p>
<ul class="simple">
<li><p>Top row with noisy images inputs</p></li>
<li><p>Middle row with reconstructions of noisy images</p></li>
<li><p>Bottom row with reconstructions of the original images (noise-free)</p></li>
</ul>
<p><img alt="Noise task" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/applications_noise.png"/></p>
<p>The bottom row helps identify samples with reconstruction issues before adding noise. This row shows the baseline reconstruction quality for these samples rather than the original images. (Why?)</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noise_factor</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="n">input_train_noisy</span> <span class="o">=</span> <span class="p">(</span><span class="n">input_train</span>
                     <span class="o">+</span> <span class="n">noise_factor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">input_train</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">input_train_noisy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">input_train_noisy</span><span class="p">,</span> <span class="n">input_train</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                            <span class="n">input_train</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">input_test_noisy</span> <span class="o">=</span> <span class="p">(</span><span class="n">input_test</span>
                    <span class="o">+</span> <span class="n">noise_factor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">input_test</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">input_test_noisy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">,</span> <span class="n">input_test</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                           <span class="n">input_test</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_noisy</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">)</span>
  <span class="n">latent_test_noisy</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/1ce6c560d29798142458913651b2fc564c4f2edc1a4a21a6bb37b01e22cead42.png" src="../../../_images/1ce6c560d29798142458913651b2fc564c4f2edc1a4a21a6bb37b01e22cead42.png"/>
<img alt="../../../_images/28a1543e46cd18fdd0bb1c021abacfdcb54e420a551680c15602eeb01cd17c40.png" src="../../../_images/28a1543e46cd18fdd0bb1c021abacfdcb54e420a551680c15602eeb01cd17c40.png"/>
<img alt="../../../_images/faf91425432685167626ec7b1b0ce8b36b1caec982d6c7c958a0d5a7175bd302.png" src="../../../_images/faf91425432685167626ec7b1b0ce8b36b1caec982d6c7c958a0d5a7175bd302.png"/>
</div>
</div>
</section>
<section id="latent-space-before-fine-tuning">
<h3>Latent space before fine-tuning<a class="headerlink" href="#latent-space-before-fine-tuning" title="Permalink to this heading">#</a></h3>
<p>We investigate the origin of reconstruction errors by looking at how adding noise to input affects latent space coordinates. The decoder interprets significant coordinate changes as different digits.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">plot_latent_ab</span></code> compares latent space coordinates for the same set of samples between two conditions.  Here, we display coordinates for the ten samples from the previous cell before and after adding noise:</p>
<ul class="simple">
<li><p>The left plot shows the coordinates of the original samples (noise-free)</p></li>
<li><p>The plot on the right shows the new coordinates after adding noise</p></li>
</ul>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_noisy</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before noise'</span><span class="p">,</span> <span class="n">title_b</span><span class="o">=</span><span class="s1">'After noise'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/cc857278f33774e5eef68f69fbf06c916c4fc969dcc267e837c07d829579c028.png" src="../../../_images/cc857278f33774e5eef68f69fbf06c916c4fc969dcc267e837c07d829579c028.png"/>
</div>
</div>
</section>
<section id="fine-tuning-the-autoencoder-with-noisy-images">
<h3>Fine-tuning the autoencoder with noisy images<a class="headerlink" href="#fine-tuning-the-autoencoder-with-noisy-images" title="Permalink to this heading">#</a></h3>
<p>Let’s re-train the autoencoder with noisy images on the input and original (noise-free) images on the output, and regenerate the previous plots.</p>
<p>We now see that both noisy and noise-free images match similar locations in latent space. The network denoises the input with a latent-space representation that is more robust to noise.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_train_noisy</span><span class="p">,</span> <span class="n">input_test_noisy</span><span class="p">,</span>
       <span class="n">out_train</span><span class="o">=</span><span class="n">input_train</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="n">input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.1732		 0.1742
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1724		 0.1738
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1716		 0.1731
</pre></div>
</div>
<img alt="../../../_images/c1b7b5631de1aa92ae142abfc1c81e48e8ae480eb1bf0472e882947159200602.png" src="../../../_images/c1b7b5631de1aa92ae142abfc1c81e48e8ae480eb1bf0472e882947159200602.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_noisy</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">)</span>
  <span class="n">latent_test_noisy</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_noisy</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/1ce6c560d29798142458913651b2fc564c4f2edc1a4a21a6bb37b01e22cead42.png" src="../../../_images/1ce6c560d29798142458913651b2fc564c4f2edc1a4a21a6bb37b01e22cead42.png"/>
<img alt="../../../_images/485ff6eb25171fe6e2a07d3706b813253795b2534cd1551ee72e133947332ef2.png" src="../../../_images/485ff6eb25171fe6e2a07d3706b813253795b2534cd1551ee72e133947332ef2.png"/>
<img alt="../../../_images/5874be9ac965b74a858f647fb539d3cfa0c18293d66887ec8f91cf8eafd2c2ca.png" src="../../../_images/5874be9ac965b74a858f647fb539d3cfa0c18293d66887ec8f91cf8eafd2c2ca.png"/>
<img alt="../../../_images/2e5fdf14ebf49f7a90a8260e8d2e35117e5559df22504e4399107ac64b88c375.png" src="../../../_images/2e5fdf14ebf49f7a90a8260e8d2e35117e5559df22504e4399107ac64b88c375.png"/>
</div>
</div>
</section>
<section id="global-latent-space-shift">
<h3>Global latent space shift<a class="headerlink" href="#global-latent-space-shift" title="Permalink to this heading">#</a></h3>
<p>The new latent space representation is more robust to noise and may result in a better internal representation of the dataset. We verify this by inspecting the latent space with clean images before and after fine-tuning with noisy images.</p>
<p>Fine-tuning the network with noisy images causes a <em>domain shift</em> in the dataset, i.e., a change in the distribution of images since the dataset was initially composed of noise-free images. Depending on the task and the extent of changes during re-train,  (number of epochs, optimizer characteristics, etc.), the new latent space representation may become less well adapted to the original data as a side-effect. How could we address <em>domain shift</em> and improve both noisy and noise-free images?</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test_ref</span><span class="p">,</span> <span class="n">latent_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_subset_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/05fa8ad6c5e878739fb974bdf8637dd639ecb0e2f87839d05b5d62d633f45050.png" src="../../../_images/05fa8ad6c5e878739fb974bdf8637dd639ecb0e2f87839d05b5d62d633f45050.png"/>
</div>
</div>
</section>
</section>
<section id="application-2-image-occlusion">
<h2>Application 2 - Image occlusion<a class="headerlink" href="#application-2-image-occlusion" title="Permalink to this heading">#</a></h2>
<p>We now investigate the effects of image occlusion. Drawing from the previous exercise, we expect the autoencoder to reconstruct complete images since the train set does not contain occluded images (right?).</p>
<p>We visualize this by plotting three rows:</p>
<ul class="simple">
<li><p>Top row with occluded images</p></li>
<li><p>Middle row with reconstructions of occluded images</p></li>
<li><p>Bottom row with reconstructions of the original images</p></li>
</ul>
<p><img alt="Occlusion task" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/applications_occlusion.png"/></p>
<p>Similarly, we investigate the source of this issue by looking at the representation of partial images in latent space and how it adjusts after fine-tuning.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset_checkpoint</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test_ref</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="before-fine-tuning">
<h3>Before fine-tuning<a class="headerlink" href="#before-fine-tuning" title="Permalink to this heading">#</a></h3>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_train_mask</span> <span class="o">=</span> <span class="n">image_occlusion</span><span class="p">(</span><span class="n">input_train</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
<span class="n">input_test_mask</span> <span class="o">=</span> <span class="n">image_occlusion</span><span class="p">(</span><span class="n">input_test</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_mask</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_mask</span><span class="p">)</span>
  <span class="n">latent_test_mask</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_mask</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_mask</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_mask</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_mask</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before occlusion'</span><span class="p">,</span> <span class="n">title_b</span><span class="o">=</span><span class="s1">'After occlusion'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ed3503a382ee00252aff4e4e454ca9e4a429b1439a46560e76f1cf2ecacc3e99.png" src="../../../_images/ed3503a382ee00252aff4e4e454ca9e4a429b1439a46560e76f1cf2ecacc3e99.png"/>
<img alt="../../../_images/224264209613f1b8a242d031a8a0f7e179f39774c2737c05a1e661b2330474ab.png" src="../../../_images/224264209613f1b8a242d031a8a0f7e179f39774c2737c05a1e661b2330474ab.png"/>
<img alt="../../../_images/faf91425432685167626ec7b1b0ce8b36b1caec982d6c7c958a0d5a7175bd302.png" src="../../../_images/faf91425432685167626ec7b1b0ce8b36b1caec982d6c7c958a0d5a7175bd302.png"/>
<img alt="../../../_images/f4b4930c494641e0c396d6686165e3198a6819194def775065c5fa2d4af89782.png" src="../../../_images/f4b4930c494641e0c396d6686165e3198a6819194def775065c5fa2d4af89782.png"/>
</div>
</div>
</section>
<section id="after-fine-tuning">
<h3>After fine-tuning<a class="headerlink" href="#after-fine-tuning" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_train_mask</span><span class="p">,</span> <span class="n">input_test_mask</span><span class="p">,</span>
       <span class="n">out_train</span><span class="o">=</span><span class="n">input_train</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="n">input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.1719		 0.1730
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1708		 0.1721
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1707		 0.1723
</pre></div>
</div>
<img alt="../../../_images/9e898277259916a9f7bccad65f23edf4c85e947d41fe4c0b836349de6b2332f2.png" src="../../../_images/9e898277259916a9f7bccad65f23edf4c85e947d41fe4c0b836349de6b2332f2.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_mask</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_mask</span><span class="p">)</span>
  <span class="n">latent_test_mask</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_mask</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_mask</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_mask</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_mask</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ed3503a382ee00252aff4e4e454ca9e4a429b1439a46560e76f1cf2ecacc3e99.png" src="../../../_images/ed3503a382ee00252aff4e4e454ca9e4a429b1439a46560e76f1cf2ecacc3e99.png"/>
<img alt="../../../_images/4719258352589490e80c2b724cd8d0746ae61e1e5478821335af89fb4d735cdb.png" src="../../../_images/4719258352589490e80c2b724cd8d0746ae61e1e5478821335af89fb4d735cdb.png"/>
<img alt="../../../_images/c924da18d8a2ff2573043b473d909df888c5cabf6e609c660c2244b71b64c3c1.png" src="../../../_images/c924da18d8a2ff2573043b473d909df888c5cabf6e609c660c2244b71b64c3c1.png"/>
<img alt="../../../_images/fc5cb2f2ca654794fe35963e90938f672c5ad035819c41d28ff77cdf420a76ba.png" src="../../../_images/fc5cb2f2ca654794fe35963e90938f672c5ad035819c41d28ff77cdf420a76ba.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test_ref</span><span class="p">,</span> <span class="n">latent_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_subset_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/8ef75a89a451e7b1b183add8f69c212bfe60aa37bf78464090e224b47a50a56e.png" src="../../../_images/8ef75a89a451e7b1b183add8f69c212bfe60aa37bf78464090e224b47a50a56e.png"/>
</div>
</div>
</section>
</section>
<section id="application-3-image-rotation">
<h2>Application 3 - Image rotation<a class="headerlink" href="#application-3-image-rotation" title="Permalink to this heading">#</a></h2>
<p>Finally, we look at the effect of image rotation in latent space coordinates. This task is arguably more challenging since it may require a complete re-write of image reconstruction.</p>
<p>We visualize this by plotting three rows:</p>
<ul class="simple">
<li><p>Top row with rotated images</p></li>
<li><p>Middle row with reconstructions of rotated images</p></li>
<li><p>Bottom row with reconstructions of the original images</p></li>
</ul>
<p><img alt="Rotation task" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/applications_rotation.png"/></p>
<p>We investigate the source of this issue by looking at the representation of rotated images in latent space and how it adjusts after fine-tuning.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset_checkpoint</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test_ref</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3>Before fine-tuning<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_train_rotation</span> <span class="o">=</span> <span class="n">image_rotation</span><span class="p">(</span><span class="n">input_train</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
<span class="n">input_test_rotation</span> <span class="o">=</span> <span class="n">image_rotation</span><span class="p">(</span><span class="n">input_test</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_rotation</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_rotation</span><span class="p">)</span>
  <span class="n">latent_test_rotation</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_rotation</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_rotation</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_rotation</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_rotation</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before rotation'</span><span class="p">,</span> <span class="n">title_b</span><span class="o">=</span><span class="s1">'After rotation'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/7f1511cd606fa00a0188a5d6226399a3426ed78be5b1429d35c31bd08fd6b663.png" src="../../../_images/7f1511cd606fa00a0188a5d6226399a3426ed78be5b1429d35c31bd08fd6b663.png"/>
<img alt="../../../_images/0dfeeba23890b6cbfdbf18686ee607be9da3808c405d085fcab49e69e1ccf221.png" src="../../../_images/0dfeeba23890b6cbfdbf18686ee607be9da3808c405d085fcab49e69e1ccf221.png"/>
<img alt="../../../_images/faf91425432685167626ec7b1b0ce8b36b1caec982d6c7c958a0d5a7175bd302.png" src="../../../_images/faf91425432685167626ec7b1b0ce8b36b1caec982d6c7c958a0d5a7175bd302.png"/>
<img alt="../../../_images/87df6fd9cb796e81aed28d57a6636ea78ae09ac883ad0986c0a1bdf7b4a2d875.png" src="../../../_images/87df6fd9cb796e81aed28d57a6636ea78ae09ac883ad0986c0a1bdf7b4a2d875.png"/>
</div>
</div>
</section>
<section id="id2">
<h3>After fine-tuning<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_train_rotation</span><span class="p">,</span> <span class="n">input_test_rotation</span><span class="p">,</span>
       <span class="n">out_train</span><span class="o">=</span><span class="n">input_train</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="n">input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/5	 0.2224		 0.2220
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/5	 0.2143		 0.2146
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/5	 0.2102		 0.2109
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4/5	 0.2079		 0.2087
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5/5	 0.2072		 0.2078
</pre></div>
</div>
<img alt="../../../_images/2922347afc318783da96d3e65ccd229cee30ca7354bb7ee5b345ab80f14fe54d.png" src="../../../_images/2922347afc318783da96d3e65ccd229cee30ca7354bb7ee5b345ab80f14fe54d.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_rotation</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_rotation</span><span class="p">)</span>
  <span class="n">latent_test_rotation</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_rotation</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_rotation</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_rotation</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_rotation</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/7f1511cd606fa00a0188a5d6226399a3426ed78be5b1429d35c31bd08fd6b663.png" src="../../../_images/7f1511cd606fa00a0188a5d6226399a3426ed78be5b1429d35c31bd08fd6b663.png"/>
<img alt="../../../_images/969c18ea2cbc50ab2d7714c003415172a652b73eaf66e879acd8a1b767e11669.png" src="../../../_images/969c18ea2cbc50ab2d7714c003415172a652b73eaf66e879acd8a1b767e11669.png"/>
<img alt="../../../_images/35ceff009ad364c6c4167673a0256eafc9df8b83a9c2348c7eda005e5f1a0a68.png" src="../../../_images/35ceff009ad364c6c4167673a0256eafc9df8b83a9c2348c7eda005e5f1a0a68.png"/>
<img alt="../../../_images/c684df372d63ac9da8a7a36dbf36dcb20f767a320214917354a76c37817326e8.png" src="../../../_images/c684df372d63ac9da8a7a36dbf36dcb20f767a320214917354a76c37817326e8.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test_ref</span><span class="p">,</span> <span class="n">latent_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_subset_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ceb4ca6466f6158346873713a6515727f81f13819708aed9fe0f0fca13fe8e85.png" src="../../../_images/ceb4ca6466f6158346873713a6515727f81f13819708aed9fe0f0fca13fe8e85.png"/>
</div>
</div>
</section>
</section>
<section id="application-4-what-would-digit-6-look-like-if-we-had-never-seen-it-before">
<h2>Application 4 - What would digit “6” look like if we had never seen it before?<a class="headerlink" href="#application-4-what-would-digit-6-look-like-if-we-had-never-seen-it-before" title="Permalink to this heading">#</a></h2>
<p>Before we start melting our brains with such an impossible task, let’s just ask the autoencoder to do it!</p>
<p>We train the autoencoder from scratch without digit class <code class="docutils literal notranslate"><span class="pre">6</span></code> and visualize reconstructions from digit <code class="docutils literal notranslate"><span class="pre">6</span></code>.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">(</span><span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">my_input_train</span> <span class="o">=</span> <span class="n">input_train</span><span class="p">[</span><span class="n">y_train</span> <span class="o">!=</span> <span class="n">missing</span><span class="p">]</span>
<span class="n">my_input_test</span> <span class="o">=</span> <span class="n">input_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">!=</span> <span class="n">missing</span><span class="p">]</span>
<span class="n">my_y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">!=</span> <span class="n">missing</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">my_input_train</span><span class="p">,</span> <span class="n">my_input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
  <span class="n">my_latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">my_input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.1873		 0.1861
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1818		 0.1809
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1771		 0.1763
</pre></div>
</div>
<img alt="../../../_images/6db698fddf92af89a0a72569edba69a957154c946f5c42995f87c40683f153c1.png" src="../../../_images/6db698fddf92af89a0a72569edba69a957154c946f5c42995f87c40683f153c1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_row</span><span class="p">([</span><span class="n">input_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">6</span><span class="p">],</span> <span class="n">output_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">6</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_generative</span><span class="p">(</span><span class="n">my_latent_test</span><span class="p">,</span> <span class="n">my_y_test</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span>
                       <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/8e73e1418d780ede4896f8e69bd1119d7ffada5198aa239b6edce4a575668b06.png" src="../../../_images/8e73e1418d780ede4896f8e69bd1119d7ffada5198aa239b6edce4a575668b06.png"/>
<img alt="../../../_images/9be2b2a4e9e3c36f88ec87a6eea0474949242e067874db745054d1cfe024cd3f.png" src="../../../_images/9be2b2a4e9e3c36f88ec87a6eea0474949242e067874db745054d1cfe024cd3f.png"/>
<img alt="../../../_images/9422c0f461e38cc6e464e51eab62c18808a96800f8bc4abc37098da0cd561da2.png" src="../../../_images/9422c0f461e38cc6e464e51eab62c18808a96800f8bc4abc37098da0cd561da2.png"/>
</div>
</div>
<section id="coding-exercise-1-removing-the-most-dominant-digit-classes">
<h3>Coding Exercise 1: Removing the most dominant digit classes<a class="headerlink" href="#coding-exercise-1-removing-the-most-dominant-digit-classes" title="Permalink to this heading">#</a></h3>
<p>Digit classes <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code> are dominant in the sense that these occupy large areas of the decoder grid, compared to other digit classes that occupy very little generative space.</p>
<p>How will latent space change when removing the two most dominant digit classes? Will latent space re-distribute evenly among remaining classes or choose another two dominant classes?</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
<li><p>The intersection of two boolean arrays by condition is specified as <code class="docutils literal notranslate"><span class="pre">x[(cond_a)&amp;(cond_b)]</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">(</span><span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">missing_b</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#####################################################################</span>
<span class="c1"># Fill in missing code (...),</span>
<span class="c1"># then remove or comment the line below to test your function</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Complete the code elements below!"</span><span class="p">)</span>
<span class="c1">#####################################################################</span>
<span class="c1"># input train data</span>
<span class="n">my_input_train</span> <span class="o">=</span> <span class="o">...</span>
<span class="c1"># input test data</span>
<span class="n">my_input_test</span> <span class="o">=</span> <span class="o">...</span>
<span class="c1"># model</span>
<span class="n">my_y_test</span> <span class="o">=</span> <span class="o">...</span>

<span class="nb">print</span><span class="p">(</span><span class="n">my_input_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_input_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>

</div>
<p><strong>SAMPLE OUTPUT</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">47335</span><span class="p">,</span> <span class="mi">784</span><span class="p">])</span>
<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">7885</span><span class="p">,</span> <span class="mi">784</span><span class="p">])</span>
<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">7885</span><span class="p">])</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/neuromatch/course-content-template/tree/main/tutorials/Bonus_BonusContent/solutions/Bonus_Tutorial3_Solution_22e2c431.py"><em>Click for solution</em></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">my_input_train</span><span class="p">,</span> <span class="n">my_input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
  <span class="n">my_latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">my_input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.1947		 0.1937
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1816		 0.1807
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1787		 0.1781
</pre></div>
</div>
<img alt="../../../_images/d5bd9c773d2fcbfc033ea16a9aaacec477929583444f654676d952c4b174e3e6.png" src="../../../_images/d5bd9c773d2fcbfc033ea16a9aaacec477929583444f654676d952c4b174e3e6.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_row</span><span class="p">([</span><span class="n">input_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="n">missing_a</span><span class="p">],</span> <span class="n">output_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="n">missing_a</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="n">missing_b</span><span class="p">],</span> <span class="n">output_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="n">missing_b</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_generative</span><span class="p">(</span><span class="n">my_latent_test</span><span class="p">,</span> <span class="n">my_y_test</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span>
                       <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/38b61831a51154e1f3db5baf28c7626c7c39b5d3959541d6d4408c465feb9f08.png" src="../../../_images/38b61831a51154e1f3db5baf28c7626c7c39b5d3959541d6d4408c465feb9f08.png"/>
<img alt="../../../_images/1f94d811aa1ea2fd12694342334ef37a8c97f6e8f835d9fd3f5a4223ee8020df.png" src="../../../_images/1f94d811aa1ea2fd12694342334ef37a8c97f6e8f835d9fd3f5a4223ee8020df.png"/>
<img alt="../../../_images/20e1e0b627427ee9523582548b3c15581dd9599b3492243390863c2b8e27dc21.png" src="../../../_images/20e1e0b627427ee9523582548b3c15581dd9599b3492243390863c2b8e27dc21.png"/>
<img alt="../../../_images/ae1d53f919221d62a78836153a8e3f41c39ce0e135f6a1a6822f8ce226fd8c8f.png" src="../../../_images/ae1d53f919221d62a78836153a8e3f41c39ce0e135f6a1a6822f8ce226fd8c8f.png"/>
<img alt="../../../_images/afa40272e32299cfae43886bfbc749345fa83c6ed476224e51058f0dd7c38747.png" src="../../../_images/afa40272e32299cfae43886bfbc749345fa83c6ed476224e51058f0dd7c38747.png"/>
</div>
</div>
<section id="id3">
<h4>Submit your feedback<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Removing_the_most_dominant_class_Exercise"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "c064686425a2460f94b83edf6929d66b"}</script></div>
</div>
</section>
</section>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-4-anns-same-but-different">
<h1>Section 4: ANNs? Same but different!<a class="headerlink" href="#section-4-anns-same-but-different" title="Permalink to this heading">#</a></h1>
<p>“Same same but different” is an expression used in some parts of Asia to express differences between supposedly similar subjects. In this exercise, we investigate a fundamental difference in how fully-connected ANNs process visual information compared to human vision.</p>
<p>The previous exercises showed ANN autoencoder performing cognitive tasks with relative ease. However, there is a crucial aspect of ANN processing already encoded in the vectorization of images. This network architecture completely ignores the relative position of pixels. To illustrate this, we show that learning proceeds just as well with shuffled pixel locations.</p>
<p>First, we obtain a reversible shuffle map stored in <code class="docutils literal notranslate"><span class="pre">shuffle_image_idx</span></code> used to shuffle image pixels randomly.</p>
<br/>
<p><img alt="mnist_pixel_shuffle" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/mnist_pixel_shuffle.png"/></p>
<br/>
<p>The unshuffled image set <code class="docutils literal notranslate"><span class="pre">input_shuffle</span></code> is recovered as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">input_shuffle</span><span class="p">[:,</span> <span class="n">shuffle_rev_image_idx</span><span class="p">]]</span>
</pre></div>
</div>
<p>First, we set up the reversible shuffle map and visualize a few images with shuffled and unshuffled pixels, followed by their noisy versions.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create forward and reverse indexes for pixel shuffling</span>
<span class="n">shuffle_image_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">input_size</span><span class="p">)</span>
<span class="n">shuffle_rev_image_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">shuffle_image_idx</span><span class="p">)</span>

<span class="c1"># shuffle pixel location</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">shuffle_image_idx</span><span class="p">)</span>

<span class="c1"># store reverse locations</span>
<span class="k">for</span> <span class="n">pos_idx</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shuffle_image_idx</span><span class="p">):</span>
  <span class="n">shuffle_rev_image_idx</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos_idx</span>

<span class="c1"># shuffle train and test sets</span>
<span class="n">input_train_shuffle</span> <span class="o">=</span> <span class="n">input_train</span><span class="p">[:,</span> <span class="n">shuffle_image_idx</span><span class="p">]</span>
<span class="n">input_test_shuffle</span> <span class="o">=</span> <span class="n">input_test</span><span class="p">[:,</span> <span class="n">shuffle_image_idx</span><span class="p">]</span>

<span class="n">input_train_shuffle_noisy</span> <span class="o">=</span> <span class="n">input_train_noisy</span><span class="p">[:,</span> <span class="n">shuffle_image_idx</span><span class="p">]</span>
<span class="n">input_test_shuffle_noisy</span> <span class="o">=</span> <span class="n">input_test_noisy</span><span class="p">[:,</span> <span class="n">shuffle_image_idx</span><span class="p">]</span>

<span class="c1"># show samples with shuffled pixels</span>
<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_shuffle</span><span class="p">,</span>
          <span class="n">input_test_shuffle</span><span class="p">[:,</span> <span class="n">shuffle_rev_image_idx</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a738f93eec8eac7f60cd06ba963fa3d0fc2da91f5253bd5880615cda4d853693.png" src="../../../_images/a738f93eec8eac7f60cd06ba963fa3d0fc2da91f5253bd5880615cda4d853693.png"/>
<img alt="../../../_images/fad699bfdb8778a722961ad9c98dd8ff27b74d308c2ccb3ac5409b30ac671b57.png" src="../../../_images/fad699bfdb8778a722961ad9c98dd8ff27b74d308c2ccb3ac5409b30ac671b57.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show noisy samples with shuffled pixels</span>
<span class="n">plot_row</span><span class="p">([</span><span class="n">input_train_shuffle_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">input_train_shuffle_noisy</span><span class="p">[:,</span> <span class="n">shuffle_rev_image_idx</span><span class="p">][</span><span class="n">test_selected_idx</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ebcb4f26529d15519096072dbc80f4a71036536b023b3ae7a299633af86988bf.png" src="../../../_images/ebcb4f26529d15519096072dbc80f4a71036536b023b3ae7a299633af86988bf.png"/>
<img alt="../../../_images/357793c690b5fde847df965d905ea2eb17ec57a4d3ac14d8df967969d6636a67.png" src="../../../_images/357793c690b5fde847df965d905ea2eb17ec57a4d3ac14d8df967969d6636a67.png"/>
</div>
</div>
<p>We initialize and train the network in the denoising task with shuffled pixels.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">(</span><span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span>

<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="c1"># train the model to denoise shuffled images</span>
<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_train_shuffle_noisy</span><span class="p">,</span> <span class="n">input_test_shuffle_noisy</span><span class="p">,</span>
       <span class="n">out_train</span><span class="o">=</span><span class="n">input_train_shuffle</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="n">input_test_shuffle</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.2004		 0.2000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1883		 0.1885
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1837		 0.1841
</pre></div>
</div>
<img alt="../../../_images/e85e8bd80cac042e2e6b832bdd883c125b7112c7247fdc196e8e8e42d779b98a.png" src="../../../_images/e85e8bd80cac042e2e6b832bdd883c125b7112c7247fdc196e8e8e42d779b98a.png"/>
</div>
</div>
<p>Finally, visualize reconstructions and latent space representation with the trained model.</p>
<p>We visualize reconstructions by plotting three rows:</p>
<ul class="simple">
<li><p>Top row with shuffled noisy images</p></li>
<li><p>Middle row with reconstructions of shuffled denoised images</p></li>
<li><p>Bottom row with unshuffled reconstructions of denoised images</p></li>
</ul>
<p><img alt="mnist_pixel_shuffle denoised" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/applications_ann_denoise.png"/></p>
<p>We obtain the same organization in the encoder map as before. Sharing similar internal representations confirms the network to ignore the relative position of pixels. The decoder grid is different than before since it generates shuffled images.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test_shuffle_noisy</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_shuffle_noisy</span><span class="p">)</span>
  <span class="n">output_test_shuffle_noisy</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_shuffle_noisy</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_shuffle_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_shuffle_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_shuffle_noisy</span><span class="p">[:,</span> <span class="n">shuffle_rev_image_idx</span><span class="p">][</span><span class="n">test_selected_idx</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_generative</span><span class="p">(</span><span class="n">latent_test_shuffle_noisy</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span>
                       <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/37602ef0e344ee2b1665d52c11b37f17de830b814b64ca4ebc9ae5f6b174449c.png" src="../../../_images/37602ef0e344ee2b1665d52c11b37f17de830b814b64ca4ebc9ae5f6b174449c.png"/>
<img alt="../../../_images/f102084ca6ee37c5c1c73d05d38b22abb0e92734754e71e1dd09af22297cac58.png" src="../../../_images/f102084ca6ee37c5c1c73d05d38b22abb0e92734754e71e1dd09af22297cac58.png"/>
<img alt="../../../_images/e20cb44004fcfb123783dbb8482e40e6ac6c471c3fd37b9db720cae250493826.png" src="../../../_images/e20cb44004fcfb123783dbb8482e40e6ac6c471c3fd37b9db720cae250493826.png"/>
<img alt="../../../_images/7bba33389ff54be15a55fd010df11cdc1ebd3832d40ed68e8fc24ed40ffc7317.png" src="../../../_images/7bba33389ff54be15a55fd010df11cdc1ebd3832d40ed68e8fc24ed40ffc7317.png"/>
</div>
</div>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h1>
<p>Hooray! You have finished the last Tutorial of NMA 2020!</p>
<p>We hope you’ve enjoyed these tutorials and learned about the usefulness of autoencoders to model rich and non-linear representations of data. We hope you may find them useful in your research, perhaps to model certain aspects of cognition or even extend them to biologically plausible architectures - autoencoders of spiking neurons, anyone?</p>
<p>These are the key take away messages from these tutorials:</p>
<p><strong>Autoencoders trained in <em>learning by doing</em> tasks such as compression/decompression, removing noise, etc. can uncover rich lower-dimensional structure embedded in structured images and other cognitively relevant data.</strong></p>
<p><strong>The data domain seen during training imprints a “cognitive bias” - you only see what you expect to see, which can only be similar to what you saw before.</strong></p>
<p>Such bias is related to the concept <a class="reference external" href="https://en.wikipedia.org/wiki/Thinking,_Fast_and_Slow"><em>What you see is all there is</em></a> coined by Daniel Kahneman in psychology.</p>
<p>For additional applications of autoencoders to neuroscience, check the spike sorting application in the outro video, and also see <a class="reference external" href="https://www.nature.com/articles/s41592-018-0109-9">here</a> how to replicate the input-output relationship of real networks of neurons with autoencoders.</p>
<section id="video-2-wrap-up">
<h2>Video 2: Wrap-up<a class="headerlink" href="#video-2-wrap-up" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "4ec98b64c79d41a79d0a3718ad49be29"}</script></div>
</div>
</section>
<section id="id4">
<h2>Submit your feedback<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_WrapUp_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "66b2a4924ca34666a5d744b9dfdc8c53"}</script></div>
</div>
</section>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tutorials/Bonus_BonusContent/student"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</article>
<footer class="bd-footer-article">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="Bonus_Tutorial2.html" id="prev-link" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Tutorial 2: Autoencoder extensions</p>
</div>
</a>
<a class="right-next" href="Bonus_Outro.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Outro</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc">
<div class="toc-item">
<div class="tocsection onthispage">
<i class="fa-solid fa-list"></i> On this page
</div>
<nav class="page-toc" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 3: Autoencoders applications
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#autoencoder-applications">
     Autoencoder applications
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-0-introduction">
   Section 0: introduction
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-applications">
     Video 1: Applications
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-download-and-prepare-mnist-dataset">
   Section 1: Download  and prepare MNIST dataset
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-download-a-pre-trained-model">
   Section 2: Download a pre-trained model
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-applications-of-autoencoders">
   Section 3: Applications of autoencoders
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-1-image-noise">
     Application 1 - Image noise
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#reconstructions-before-fine-tuning">
       Reconstructions before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#latent-space-before-fine-tuning">
       Latent space before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#fine-tuning-the-autoencoder-with-noisy-images">
       Fine-tuning the autoencoder with noisy images
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#global-latent-space-shift">
       Global latent space shift
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-2-image-occlusion">
     Application 2 - Image occlusion
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#before-fine-tuning">
       Before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#after-fine-tuning">
       After fine-tuning
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-3-image-rotation">
     Application 3 - Image rotation
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
       After fine-tuning
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-4-what-would-digit-6-look-like-if-we-had-never-seen-it-before">
     Application 4 - What would digit “6” look like if we had never seen it before?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-removing-the-most-dominant-digit-classes">
       Coding Exercise 1: Removing the most dominant digit classes
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-anns-same-but-different">
   Section 4: ANNs? Same but different!
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-wrap-up">
     Video 2: Wrap-up
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
     Submit your feedback
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
<div class="footer-item">
<p class="component-author">
By Neuromatch
</p>
</div>
<div class="footer-item">
</div>
<div class="footer-item">
<p class="last-updated">
Last updated on None.<br/>
</p>
</div>
<div class="footer-item">
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</div>
</div>
</div>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>
</body>
</html>